{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/modules/OV/storage.ts","webpack:///./src/modules/OV/messages.ts","webpack:///./src/modules/OV/tools.ts","webpack:///./src/modules/OV/environment.ts","webpack:///./src/modules/OV/analytics.ts","webpack:///./src/modules/OV/page.ts","webpack:///./src/modules/OV/languages.ts","webpack:///./src/modules/Messages/background.ts","webpack:///./src/modules/redirect_scripts_base.ts","webpack:///./src/modules/video_types.ts","webpack:///./src/modules/OV/proxy.ts","webpack:///./src/page_scripts/videoplay.ts","webpack:///./src/modules/Messages/metadata.ts","webpack:///./src/modules/ov_player.ts","webpack:///./src/modules/ov_player_components.ts","webpack:///./src/modules/Messages/theatremode.ts"],"names":[],"mappings":"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","file":"pages/videoplay/videoplay.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 14);\n","import * as Messages from \"./messages\";\r\nimport * as Environment from \"./environment\";\r\n\r\nexport const enum StorageScopes {\r\n    Local = \"local\",\r\n    Sync = \"sync\"\r\n}\r\nexport function setup() {\r\n    Messages.setupBackground({\r\n        getStorageData: function(msg, bgdata: any, sender, sendResponse) {\r\n            chrome.storage.local.get(bgdata.name, function(item) {\r\n                sendResponse(item[bgdata.name]);\r\n            });\r\n\r\n        },\r\n        setStorageData: function(msg, bgdata: any, sender, sendResponse) {\r\n            chrome.storage.local.set({ [bgdata.name]: bgdata.value }, function() {\r\n                sendResponse({ success: true });\r\n            });\r\n        }\r\n    });\r\n}\r\nexport module local {\r\n    export function get(name: string): Promise<any> {\r\n        if (Environment.isBackgroundPage()) {\r\n            return new Promise(function(resolve, reject) {\r\n                chrome.storage.local.get(name, function(item) {\r\n                    resolve(item[name]);\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            return Messages.send({ bgdata: { func: \"getStorageData\", data: { scope: \"local\", name: name } } }).then(function(response) {\r\n                return response.data;\r\n            });\r\n        }\r\n    }\r\n    export function set(name: string, value: any): Promise<{ success: boolean }> {\r\n        if (Environment.isBackgroundPage()) {\r\n            return new Promise(function(resolve, reject) {\r\n                chrome.storage.local.set({ [name]: value }, function() {\r\n                    resolve({ success: true });\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            return Messages.send({ bgdata: { func: \"setStorageData\", data: { scope: \"local\", name: name, value: value } } }).then(function() {\r\n                return { success: true };\r\n            });\r\n        }\r\n    }\r\n}\r\nexport module sync {\r\n    export function get(name: string): Promise<any> {\r\n        if (Environment.isBackgroundPage()) {\r\n            return new Promise(function(resolve, reject) {\r\n                chrome.storage.sync.get(name, function(item) {\r\n                    resolve(item[name]);\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            return Messages.send({ bgdata: { func: \"getStorageData\", data: { scope: \"sync\", name: name } } }).then(function(response) {\r\n                return response.data;\r\n            });\r\n        }\r\n    }\r\n    export function set(name: string, value: any): Promise<{ success: boolean }> {\r\n        if (Environment.isBackgroundPage()) {\r\n            return new Promise(function(resolve, reject) {\r\n                chrome.storage.sync.set({ [name]: value }, function() {\r\n                    resolve({ success: true });\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            return Messages.send({ bgdata: { func: \"setStorageData\", data: { scope: \"sync\", name: name, value: value } } }).then(function() {\r\n                return { success: true };\r\n            });\r\n        }\r\n    }\r\n}","import * as Tools from \"./tools\";\r\n\r\nexport enum State {\r\n    EvToMdw = \"EvToMdw\",\r\n    MdwToBG = \"MdwToBG\",\r\n    BGToMdw = \"BGToMdw\",\r\n    MdwToEv = \"MdwToEv\",\r\n    EvToMdwRsp = \"EvToMdwRsp\",\r\n    MdwToBGRsp = \"MdwToBGRsp\",\r\n    BGToMdwRsp = \"BGToMdwRsp\",\r\n    MdwToEvRsp = \"MdwToEvRsp\"\r\n}\r\nexport interface BackgroundData {\r\n    data: any;\r\n    func: string;\r\n}\r\nexport interface Message {\r\n    data: any;\r\n    state: State;\r\n    sender: chrome.runtime.MessageSender;\r\n    error?: Error;\r\n}\r\nexport interface Request extends Message {\r\n    func: string;\r\n    bgdata: BackgroundData | null;\r\n}\r\nexport interface Response extends Message {\r\n    call: Request;\r\n}\r\nexport type SendResponse = (value: any) => void;\r\nexport type SendError = (e : Error) => void;\r\n\r\ninterface EventMessage<T extends Message> {\r\n    hash: string;\r\n    data: T;\r\n}\r\n\r\nexport interface ListenerSetup {\r\n    [key: string]: (request: Request, sendResponse: SendResponse, sendError: SendError) => void | { blocked: boolean }\r\n}\r\nlet lnfunctions: ListenerSetup = null;\r\nlet blockedFuncs: Array<string> = [];\r\nexport function addListener(functions: ListenerSetup): void {\r\n    if (lnfunctions) {\r\n        lnfunctions = Tools.merge(lnfunctions, functions);\r\n    }\r\n    else {\r\n        lnfunctions = functions;\r\n        document.addEventListener('ovmessage', function(ev: Event) {\r\n            let event = ev as CustomEvent<EventMessage<Request>>;\r\n            var details = event.detail;\r\n            if (details && lnfunctions[details.data.func] && details.data.state === State.MdwToEv && blockedFuncs.indexOf(details.data.func) == -1) {\r\n                let sendMsg = function(data : any, error?: Error) {\r\n                    let dtl = {\r\n                        hash: details.hash,\r\n                        data: {\r\n                            data: data,\r\n                            state: State.EvToMdwRsp,\r\n                            call: details.data,\r\n                            sender: { url: location.href }\r\n                        }\r\n                    } as EventMessage<Response>;\r\n                    if(error) {\r\n                        dtl.data.error = error;\r\n                        console.error(error);\r\n                    };\r\n                    var event = new CustomEvent('ovmessage', {\r\n                        detail: dtl\r\n                    });\r\n                    sendMsg = function(data : any, error?: Error){};\r\n                    document.dispatchEvent(event);\r\n                }\r\n                try {\r\n                    var result = lnfunctions[details.data.func](details.data, function(data) {\r\n                        sendMsg(data);\r\n                    }, function(error){\r\n                        sendMsg(null, error);\r\n                    });\r\n                }\r\n                catch (e) {\r\n                    if(e instanceof Error) {\r\n                        sendMsg(null, e as Error);\r\n                    }\r\n                    else {\r\n                        sendMsg(null, new Error(e));\r\n                    }\r\n                }\r\n                if (result && result.blocked) {\r\n                    blockedFuncs.push(details.data.func);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\nexport function send(obj: { data?: any; func?: string; bgdata?: BackgroundData | null }): Promise<Response> {\r\n\r\n    return eventPingPong({\r\n        func: obj.func || \"NO_FUNCTION\",\r\n        data: obj.data || {},\r\n        sender: { url: location.href },\r\n        bgdata: obj.bgdata,\r\n        state: State.EvToMdw\r\n    }, true).then(function(response){\r\n        if(response.error) {\r\n            console.error(response.error);\r\n            throw response.error;\r\n        }\r\n        else {\r\n            return response;\r\n        }\r\n    });\r\n}\r\nfunction eventPingPong(data: Request, beforeBG: boolean): Promise<Response> {\r\n    return new Promise(function(resolve, reject) {\r\n        data.state = beforeBG ? State.EvToMdw : State.MdwToEv;\r\n\r\n        let hash = Tools.generateHash();\r\n        let one = function(ev: Event): void {\r\n            \r\n            let event = ev as CustomEvent<EventMessage<Response>>;\r\n            var details = event.detail;\r\n            \r\n            if (details && details.hash === hash && details.data.state === (beforeBG ? State.MdwToEvRsp : State.EvToMdwRsp)) {\r\n                document.removeEventListener('ovmessage', one);\r\n                resolve(details.data);\r\n            }\r\n        };\r\n        document.addEventListener('ovmessage', one);\r\n\r\n        let event = new CustomEvent('ovmessage', {\r\n            detail: {\r\n                hash: hash,\r\n                data: data\r\n            } as EventMessage<Request>\r\n        });\r\n        document.dispatchEvent(event);\r\n    });\r\n\r\n}\r\nlet isMiddleware_ = false;\r\nexport function isMiddleware() {\r\n    return isMiddleware;\r\n}\r\nexport function setupMiddleware() {\r\n    if (isMiddleware_) {\r\n        throw Error(\"Middleware already set up!\")\r\n    }\r\n    else {\r\n        isMiddleware_ = true;\r\n        document.addEventListener('ovmessage', function(ev: Event) {\r\n            \r\n            let event = ev as CustomEvent<EventMessage<Request>>;\r\n            var details = event.detail;\r\n            \r\n            if (details && details.data.state === State.EvToMdw) {\r\n                details.data.state = State.MdwToBG;\r\n\r\n                if (details.data.bgdata) {\r\n\r\n                    chrome.runtime.sendMessage(details.data, function(resData: Response) {\r\n                        if (resData.state === State.BGToMdwRsp) {\r\n\r\n                            var event = new CustomEvent('ovmessage', {\r\n                                detail: {\r\n                                    hash: details.hash,\r\n                                    data: {\r\n                                        data: resData.data,\r\n                                        state: State.MdwToEvRsp,\r\n                                        call: resData.call,\r\n                                        sender: resData.sender\r\n                                    }\r\n                                } as EventMessage<Response>\r\n                            });\r\n                            document.dispatchEvent(event);\r\n                        }\r\n                        else {\r\n                            throw Error(\"Wrong Response!\")\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    \r\n                    eventPingPong(details.data, false).then(function(response) {\r\n\r\n                        var event = new CustomEvent('ovmessage', {\r\n                            detail: {\r\n                                hash: details.hash,\r\n                                data: {\r\n                                    data: response.data,\r\n                                    state: State.MdwToEvRsp,\r\n                                    call: response.call,\r\n                                    sender: response.sender\r\n                                }\r\n                            } as EventMessage<Response>\r\n                        });\r\n                        document.dispatchEvent(event);\r\n                    });\r\n                }\r\n            }\r\n\r\n        });\r\n        chrome.runtime.onMessage.addListener(function(msg: Request, sender, sendResponse) {\r\n            if (msg.state === State.BGToMdw) {\r\n\r\n                eventPingPong({\r\n                    func: msg.func,\r\n                    data: msg.data,\r\n                    sender: sender,\r\n                    state: State.MdwToEv,\r\n                    bgdata: msg.bgdata\r\n                }, false).then(function(response) {\r\n\r\n                    sendResponse({ data: response.data, state: State.MdwToBGRsp, call: response.call, sender: response.sender } as Response);\r\n                });\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n}\r\nlet bgfunctions: BackgroundSetup = null;\r\nexport interface BackgroundSetup {\r\n    [key: string]: (msg: Request, bgData: any, sender: chrome.runtime.MessageSender, sendResponse: SendResponse, sendError: SendError) => void;\r\n}\r\nexport function setupBackground(functions: BackgroundSetup) {\r\n    if (bgfunctions) {\r\n        bgfunctions = Tools.merge(bgfunctions, functions);\r\n    }\r\n    else {\r\n        bgfunctions = functions;\r\n        chrome.runtime.onMessage.addListener(function(msg: Request, sender, sendResponse) {\r\n            if (msg.state === State.MdwToBG) {\r\n\r\n                if (bgfunctions[msg.bgdata.func]) {\r\n                    let sendMsg = function(data : any, error?: Error) {\r\n                        let resp = { data: data, state: State.BGToMdwRsp, call: msg, sender: sender } as Response;\r\n                        if(error) {\r\n                            console.error(error);\r\n                            resp.error = error;\r\n                        }\r\n                        sendMsg = function(data : any, error?: Error){};\r\n                        sendResponse(resp);\r\n                    }\r\n                    try {\r\n                        bgfunctions[msg.bgdata.func]({ func: msg.func, data: msg.data, state: State.BGToMdw, sender: sender, bgdata: msg.bgdata }, msg.bgdata.data, sender, function(response: any) {\r\n                            sendMsg(response);\r\n                        }, function(error : Error){\r\n                            sendMsg(null, error);\r\n                        });\r\n                    }\r\n                    catch(e) {\r\n                        if(e instanceof Error) {\r\n                            sendMsg(null, e as Error);\r\n                        }\r\n                        else {\r\n                            sendMsg(null, new Error(e));\r\n                        }\r\n                    }\r\n                    \r\n                    return true;\r\n                }\r\n\r\n            }\r\n            return false;\r\n        });\r\n    }\r\n}","import { StringMap } from \"./types\";\r\n\r\n\r\nexport function generateHash(): string {\r\n    var ts = Math.round(+new Date() / 1000.0);\r\n    var rand = Math.round(Math.random() * 2147483647);\r\n    return [rand, ts].join('.');\r\n}\r\nexport function merge<T1, T2>(obj1: T1, obj2: T2): T1 & T2 {\r\n    return (<any>Object).assign({}, obj1, obj2);\r\n}\r\nexport function eventOne(elem: Node, type: string) {\r\n    return new Promise<Event>(function(resolve, reject) {\r\n        elem.addEventListener(type, function one(e: Event) {\r\n            elem.removeEventListener(type, one);\r\n            resolve(e);\r\n        });\r\n    });\r\n}\r\nexport function matchNull(str: string, regexp: RegExp, index?: number) {\r\n    return (str.match(regexp) || [])[index || 1] || \"\";\r\n}\r\nexport function objToHash(obj: Object): string {\r\n    if (obj) {\r\n        return \"?hash=\" + encodeURIComponent(JSON.stringify(obj));\r\n    }\r\n    else {\r\n        return \"\";\r\n    }\r\n}\r\nexport function hashToObj(hashStr: string): Object | null {\r\n    var hash = parseUrlQuery(hashStr).hash;\r\n    if (hash == \"\" || hash == undefined) {\r\n        return null;\r\n    }\r\n    else {\r\n        return JSON.parse(decodeURIComponent(hash));\r\n    }\r\n}\r\nexport function unpackJS(source: string): string {\r\n    function getUnbase(base: number) {\r\n        var ALPHABET = \"\";\r\n        if (base > 62) ALPHABET = ' !\"#$%&\\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~';\r\n        else if (base > 54) ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n        else if (base > 52) ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQR';\r\n        else ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOP';\r\n        return function(val: string) {\r\n            if (2 <= base && base <= 36) {\r\n                return parseInt(val, base);\r\n            }\r\n            else {\r\n                var valArray = val.split('').reverse();\r\n                var ret = 0;\r\n                for (var i = 0; i < valArray.length; i++) {\r\n                    var cipher = valArray[i];\r\n                    ret += Math.pow(base, i) * ALPHABET.indexOf(cipher);\r\n                }\r\n                return ret;\r\n            }\r\n        };\r\n    }\r\n    var out = source.match(/}\\('(.*)', *(\\d+), *(\\d+), *'(.*?)'\\.split\\('\\|'\\)/);\r\n\r\n    // Payload\r\n    var payload = out[1];\r\n    // Words\r\n    var symtab = out[4].split(/\\|/);\r\n    // Radix\r\n    var radix = parseInt(out[2]);\r\n    // Words Count\r\n    var count = parseInt(out[3]);\r\n\r\n    if (count != symtab.length) {\r\n        throw Error(\"Malformed p.a.c.k.e.r symtab !\");\r\n    }\r\n\r\n    var unbase = getUnbase(radix);\r\n\r\n    function lookup(matches: any) {\r\n        var word = matches;\r\n        var ub = symtab[unbase(word)];\r\n        var ret = ub ? ub : word;\r\n        return ret;\r\n    }\r\n\r\n    var result = payload.replace(/\\b\\w+\\b/g, lookup);\r\n    result = result.replace(/\\\\/g, '');\r\n    return result;\r\n}\r\nlet parseUrlOptions = {\r\n    strictMode: false,\r\n    key: [\"source\", \"protocol\", \"authority\", \"userInfo\", \"user\", \"password\", \"host\", \"port\", \"relative\", \"path\", \"directory\", \"file\", \"query\", \"anchor\"],\r\n    q: {\r\n        name: \"queryKey\",\r\n        parser: /(?:^|&)([^&=]*)=?([^&]*)/g\r\n    },\r\n    parser: {\r\n        strict: /^(?:([^:\\/?#]+):)?(?:\\/\\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?))?((((?:[^?#\\/]*\\/)*)([^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,\r\n        loose: /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/\r\n    }\r\n};\r\nexport interface URL {\r\n    source?: string;\r\n    protocol?: string;\r\n    host?: string;\r\n    port?: string;\r\n    path?: string;\r\n    query?: StringMap;\r\n    queryStr?: string;\r\n}\r\nexport function parseUrl(str: string): URL {\r\n    var o: any = parseUrlOptions,\r\n        m: any = o.parser[o.strictMode ? \"strict\" : \"loose\"].exec(str),\r\n        uri: any = {},\r\n        i = 14;\r\n\r\n    while (i--) uri[o.key[i]] = m[i] || \"\";\r\n\r\n    uri[o.q.name] = {};\r\n    uri[o.key[12]].replace(o.q.parser, function($0: any, $1: any, $2: any) {\r\n        if ($1) uri[o.q.name][$1] = $2;\r\n    });\r\n    (<any>uri).queryString = (<any>uri).query;\r\n    (<any>uri).query = parseUrlQuery(str);\r\n    return uri;\r\n}\r\nexport function parseUrlQuery(url: string): StringMap {\r\n    if (url.indexOf(\"?\") == -1) {\r\n        return {};\r\n    }\r\n    var query_string: any = {};\r\n    var query = url.substr(url.indexOf(\"?\") + 1);\r\n    var vars = query.split(\"&\");\r\n    for (var i = 0; i < vars.length; i++) {\r\n        var pair = vars[i].split(\"=\");\r\n        // If first entry with this name\r\n        if (typeof query_string[pair[0]] === \"undefined\") {\r\n            query_string[pair[0]] = decodeURIComponent(pair[1]);\r\n            // If second entry with this name\r\n        } else if (typeof query_string[pair[0]] === \"string\") {\r\n            var arr = [query_string[pair[0]], decodeURIComponent(pair[1])];\r\n            query_string[pair[0]] = arr;\r\n            // If third or later entry with this name\r\n        } else {\r\n            query_string[pair[0]].push(decodeURIComponent(pair[1]));\r\n        }\r\n    }\r\n    return query_string;\r\n}\r\nexport async function getUrlFileName(url: string): Promise<string> {\r\n    let xhr = await createRequest({ url: url, type: HTTPMethods.HEAD });\r\n    var filename = ((xhr.getResponseHeader(\"content-disposition\") || \"\").match(/filename=\"([^\"]*)/) || [])[1];\r\n    if (filename && filename != \"\") {\r\n        return filename;\r\n    }\r\n    else {\r\n        return decodeURIComponent(url.substring(url.lastIndexOf('/') + 1).replace(/[&\\?].*/, \"\"));\r\n    }\r\n}\r\nexport async function getRedirectedUrl(url: string): Promise<String> {\r\n    let xhr = await createRequest({ url: url, type: HTTPMethods.HEAD });\r\n    return xhr.responseURL;\r\n}\r\nfunction objToURLParams(url: string, obj: StringMap): string {\r\n    var str = \"\";\r\n    for (var key in obj) {\r\n        if (!isParamInURL(url, key)) {\r\n            console.log(url);\r\n            str += \"&\" + key + \"=\" + encodeURIComponent(obj[key]);\r\n        }\r\n    }\r\n    return str.substr(1);\r\n}\r\nexport function isParamInURL(url: string, param: string) {\r\n    return new RegExp(\"[\\\\?|&]\" + param + \"=\", \"i\").test(url);\r\n}\r\nexport function addParamsToURL(url: string, obj: StringMap): string {\r\n    if (url && obj) {\r\n        let query_str = objToURLParams(url, obj);\r\n        if (query_str) {\r\n            return url + (url.lastIndexOf(\"?\") < url.lastIndexOf(\"/\") ? \"?\" : \"&\") + query_str;\r\n        }\r\n        else {\r\n            return url;\r\n        }\r\n    }\r\n    else {\r\n        return url;\r\n    }\r\n}\r\nexport function removeParamsFromURL(url: string, params: String[]) {\r\n    for(let param of params) {\r\n        url = url.replace(new RegExp(\"[\\\\?&]\"+param+\"=[^\\\\?&]*\", \"i\"), \"\");\r\n    }\r\n    return url;\r\n}\r\nexport function getParamFromURL(url: string, param: string) {\r\n    var match = url.match(new RegExp(\"[\\\\?&]\"+param+\"=([^\\\\?&]*)\",\"i\"));\r\n    if(match) {\r\n        return match[1];\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n}\r\nexport function addRefererToURL(url: string, referer: string) {\r\n    return addParamsToURL(url, { OVReferer: encodeURIComponent(btoa(referer)) });\r\n}\r\nexport function getRefererFromURL(url: string) {\r\n    var param = getParamFromURL(url, \"OVReferer\");\r\n    if (param) {\r\n        return atob(decodeURIComponent(param));\r\n    }\r\n    else {\r\n        return null;\r\n    }\r\n}\r\nexport function removeRefererFromURL(url: string) {\r\n    return removeParamsFromURL(url, [\"OVReferer\"]);\r\n}\r\nexport const enum HTTPMethods {\r\n    GET = \"GET\",\r\n    POST = \"POST\",\r\n    HEAD = \"HEAD\"\r\n}\r\nexport interface Request {\r\n    url: string;\r\n    type?: HTTPMethods;\r\n    protocol?: string;\r\n    cache?: boolean;\r\n    referer?: string;\r\n    hideRef?: boolean;\r\n    headers?: StringMap;\r\n    xmlHttpObj?: XMLHttpRequest;\r\n    formData?: StringMap;\r\n    data?: StringMap;\r\n    beforeSend?: (xhr: XMLHttpRequest) => void;\r\n}\r\nexport function createRequest(args: Request): Promise<XMLHttpRequest> {\r\n    return new Promise<XMLHttpRequest>((resolve, reject) => {\r\n        let xmlHttpObj: XMLHttpRequest = null;\r\n        if (args.xmlHttpObj) {\r\n            xmlHttpObj = args.xmlHttpObj;\r\n        }\r\n        else {\r\n            xmlHttpObj = new XMLHttpRequest();\r\n        }\r\n        var type = args.type || HTTPMethods.GET;\r\n        var protocol = args.protocol || \"https://\";\r\n        if (args.referer) {\r\n            args.data = merge(args.data, { OVReferer: encodeURIComponent(btoa(args.referer)) });\r\n        }\r\n        else if (args.hideRef) {\r\n            args.data = merge(args.data, { isOV: \"true\" });\r\n        }\r\n        var url = addParamsToURL(args.url, args.data).replace(/[^:]+:\\/\\//, protocol);\r\n\r\n        xmlHttpObj.open(type, url, true);\r\n        xmlHttpObj.onload = function() {\r\n            if (xmlHttpObj.status == 200) {\r\n                resolve(xmlHttpObj);\r\n            }\r\n            else {\r\n\r\n                reject(Error(xmlHttpObj.statusText + \" (url: '\" + url + \"')\"));\r\n            }\r\n        };\r\n        xmlHttpObj.onerror = function() {\r\n\r\n            reject(Error(\"Network Error (url: '\" + url + \"')\"));\r\n        };\r\n\r\n        if (args.headers) {\r\n            for (var key in args.headers) {\r\n                xmlHttpObj.setRequestHeader(key, args.headers[key]);\r\n            }\r\n        }\r\n        let formData: FormData = null;\r\n        if (args.formData) {\r\n            formData = new FormData();\r\n            for (var key in args.formData) {\r\n                formData.append(key, args.formData[key]);\r\n            }\r\n        }\r\n\r\n\r\n        if (args.cache == false) {\r\n            xmlHttpObj.setRequestHeader('cache-control', 'no-cache, must-revalidate, post-check=0, pre-check=0');\r\n            xmlHttpObj.setRequestHeader('cache-control', 'max-age=0');\r\n            xmlHttpObj.setRequestHeader('expires', '0');\r\n            xmlHttpObj.setRequestHeader('expires', 'Tue, 01 Jan 1980 1:00:00 GMT');\r\n            xmlHttpObj.setRequestHeader('pragma', 'no-cache');\r\n        }\r\n        if (args.beforeSend) {\r\n            args.beforeSend(xmlHttpObj);\r\n        }\r\n        xmlHttpObj.send(formData);\r\n\r\n\r\n\r\n\r\n    });\r\n}\r\n","import * as Tools from \"./tools\";\r\nimport * as VideoTypes from \"./../video_types\";\r\n\r\nlet _isBGPage = false;\r\nexport function declareBGPage(): void {\r\n    _isBGPage = true;\r\n}\r\nexport function getVidPlaySiteUrl(vidHash: VideoTypes.VideoData): string {\r\n    return chrome.extension.getURL(\"/pages/videoplay/videoplay.html\") + Tools.objToHash(vidHash);\r\n}\r\nexport function getVideoSearchUrl(): string {\r\n    return chrome.extension.getURL(\"/pages/videosearch/videosearch.html\");\r\n}\r\nexport function getVidPopupSiteUrl(vidHash: Object): string {\r\n    return chrome.extension.getURL(\"/pages/videopopup/videopopup.html\") + Tools.objToHash(vidHash);\r\n}\r\nexport function getOptionsSiteUrl(): string {\r\n    return chrome.extension.getURL(\"/pages/options/options.html\");\r\n}\r\nexport function getLibrarySiteUrl(): string {\r\n    return chrome.extension.getURL(\"/pages/library/library.html\");\r\n}\r\nexport function getErrorMsg(data: any) {\r\n    return {\r\n        version: getManifest().version,\r\n        browser: browser(),\r\n        data: data\r\n    };\r\n}\r\nexport function isExtensionPage(url: string): boolean {\r\n    if (browser() == Browsers.Chrome) {\r\n        return url.indexOf(\"chrome-extension://\") != -1;\r\n    }\r\n    else {\r\n        return url.indexOf(\"moz-extension://\") != -1;\r\n    }\r\n}\r\nexport function getRoot(): string {\r\n    return chrome.extension.getURL(\"\");\r\n}\r\nexport function isBackgroundPage(): boolean {\r\n    return _isBGPage;\r\n}\r\nexport function getManifest(): any {\r\n    return chrome.runtime.getManifest();\r\n}\r\nexport const enum Browsers {\r\n    Chrome = \"chrome\",\r\n    Firefox = \"firefox\"\r\n}\r\nexport function browser(): Browsers {\r\n    if (navigator.userAgent.search(\"Firefox\") != -1) {\r\n        return Browsers.Firefox;\r\n    }\r\n    else if (navigator.userAgent.search(\"Chrome\") != -1) {\r\n        return Browsers.Chrome;\r\n    }\r\n    else {\r\n        throw Error(\"User agentis neither chrome nor Firefox\");\r\n    }\r\n}","\r\nimport { StringMap } from \"./types\";\r\nimport * as Tools from \"./tools\";\r\nimport * as Messages from \"./messages\";\r\nimport * as Environment from \"./environment\";\r\nimport * as Storage from \"./storage\";\r\n\r\n\r\nexport function getCID(): Promise<string> {\r\n    return Storage.sync.get(\"AnalyticsCID\").then(function(cid) {\r\n        if (!cid) {\r\n            cid = Tools.generateHash();\r\n            Storage.sync.set(\"AnalyticsCID\", cid);\r\n        }\r\n        return cid;\r\n    });\r\n}\r\nfunction postData(data: StringMap): Promise<XMLHttpRequest> {\r\n    return Storage.sync.get(\"AnalyticsEnabled\").then(function(value) {\r\n        if (value || value == undefined) {\r\n            return getCID().then(function(cid) {\r\n                data = Object.assign({ v: 1, tid: \"UA-118573631-1\", cid: cid }, data);\r\n                return Tools.createRequest({\r\n                    url: \"https://www.google-analytics.com/collect\",\r\n                    type: Tools.HTTPMethods.POST,\r\n                    data: data\r\n                });\r\n            });\r\n        }\r\n        return Promise.reject(Error(\"Analytics is disabled!\"));\r\n    });\r\n}\r\nfunction send(data: StringMap): Promise<{ success: boolean }> {\r\n    if (Environment.isBackgroundPage()) {\r\n        return postData(data).then(function() { return { success: true } });\r\n    }\r\n    else {\r\n        return Messages.send({ bgdata: { func: \"analytics\", data: data as StringMap } }).then(function() { return { success: true } });\r\n    }\r\n}\r\nexport function fireEvent(category: string, action: string, label: string) {\r\n    send({ t: \"event\", ec: category, ea: action, el: label });\r\n}","import * as Tools from \"./tools\";\r\nimport * as Messages from \"./messages\";\r\nimport { StringMap } from \"./types\";\r\n\r\nexport function getAbsoluteUrl(url: string): string {\r\n    let a = document.createElement('a');\r\n    a.href = url;\r\n    url = a.href;\r\n    return url;\r\n}\r\nexport function getSafeURL(url: string) {\r\n    return Tools.addRefererToURL(getAbsoluteUrl(url), location.href);\r\n}\r\nexport function isReady() {\r\n    return new Promise(function(resolve, reject) {\r\n        if (document.readyState.match(/(loaded|complete)/)) {\r\n            return Promise.resolve();\r\n        }\r\n        else {\r\n            return Tools.eventOne(document, \"DOMContentLoaded\").then(function(e: Event) {\r\n                resolve();\r\n            });\r\n        }\r\n    });\r\n}\r\nexport function onNodeInserted(target: Node, callback: (node: Node) => void) {\r\n\r\n    var observer = new MutationObserver(function(mutations) {\r\n        for (let mutation of mutations) {\r\n            for (let node of mutation.addedNodes) {\r\n                callback(node);\r\n            }\r\n        }\r\n    });\r\n    observer.observe(target, {\r\n        childList: true,\r\n        subtree: true,\r\n        attributes: false,\r\n        characterData: false,\r\n    });\r\n    return observer;\r\n}\r\ntype IDNodes = { [key: string]: HTMLElement };\r\nexport function getNodesWithID() {\r\n    let nodes = {} as IDNodes;\r\n    for (let elem of document.querySelectorAll('[id]')) {\r\n        nodes[elem.id] = elem as HTMLElement;\r\n    }\r\n    return nodes;\r\n}\r\nexport function getAttributes(elem: HTMLElement): StringMap {\r\n    let hash: StringMap = {};\r\n    for (let i = 0; i < elem.attributes.length; i++) {\r\n        hash[elem.attributes[i].name] = elem.attributes[i].value;\r\n    }\r\n    return hash;\r\n}\r\nexport function addAttributeListener(elem: HTMLElement, attribute: string, callback: (attribute: string, value: string, lastValue: string, elem: HTMLElement) => void) {\r\n    var lastValue: string = elem.getAttribute(attribute);\r\n    setInterval(function() {\r\n        var value = elem.getAttribute(attribute);\r\n\r\n        if (value != lastValue) {\r\n            callback.call(elem, attribute, value, lastValue, elem);\r\n            lastValue = value;\r\n        }\r\n    }, 10);\r\n}\r\nexport function injectScript(file: string): Promise<HTMLScriptElement> {\r\n    return isReady().then(function() {\r\n\r\n        return new Promise<HTMLScriptElement>(function(resolve, reject) {\r\n            var script = document.createElement('script');\r\n            script.src = chrome.extension.getURL(\"/inject_scripts/\" + file + \".js\");\r\n            script.async = true;\r\n            script.onload = function() {\r\n                script.onload = null;\r\n                resolve(script);\r\n            };\r\n            (document.body || document.head).appendChild(script);\r\n        });\r\n    });\r\n}\r\nexport function injectScripts(files: string[]) {\r\n    return Promise.all(files.map(injectScript));\r\n}\r\n\r\nexport function injectRawJS(source: ((data: StringMap) => void) | string, data?: StringMap) {\r\n    return new Promise(function(resolve, reject) {\r\n        var injectStr = source.toString();\r\n        injectStr = \"(\" + source + \")(\" + JSON.stringify(data || {}) + \");\";\r\n        var script = document.createElement('script');\r\n        script.appendChild(document.createTextNode(injectStr));\r\n        script.async = true;\r\n        script.onload = function() {\r\n            script.onload = null;\r\n            resolve(script);\r\n        };\r\n        document.body.appendChild(script);\r\n    });\r\n}\r\n\r\nexport function execute(files: string[], source: (data: StringMap, sendResponse: (data: StringMap) => void) => void, data?: StringMap): Promise<StringMap> {\r\n    return new Promise<StringMap>(function(resolve, reject) {\r\n        if (files.indexOf(\"openvideo\") == -1) {\r\n            files.unshift(\"openvideo\");\r\n        }\r\n\r\n        Messages.addListener({\r\n            ovInjectResponse: function(request, sendResponse) {\r\n                if (request.data.response) {\r\n                    resolve(request.data.response);\r\n                }\r\n                return { blocked: true };\r\n            }\r\n        });\r\n        var sendResponse = function(resData: any): void {\r\n            Messages.send({ func: \"ovInjectResponse\", data: { response: resData } });\r\n        }\r\n        injectScripts(files).then(function(scripts) {\r\n            return injectRawJS(\"function(data){ (\" + source + \")(data, (\" + sendResponse + \")); }\", data);\r\n        });\r\n    });\r\n}\r\n\r\nexport function lookupCSS(args: { key?: string; value?: RegExp | string; }, callback: (obj: { cssRule: any, key: string, value: RegExp | string, match: any }) => void): void {\r\n    for (let styleSheet of document.styleSheets as any) {\r\n        try {\r\n            for (let cssRule of styleSheet.cssRules) {\r\n\r\n                if (cssRule.style) {\r\n                    if (args.key) {\r\n                        if (cssRule.style[args.key].match(args.value)) {\r\n                            callback({ cssRule: cssRule, key: args.key, value: args.value, match: cssRule.style[args.key].match(args.value) });\r\n                        }\r\n                    }\r\n                    else if (args.value) {\r\n                        for (var style of cssRule.style) {\r\n                            if (cssRule.style[style] && cssRule.style[style].match(args.value)) {\r\n                                callback({ cssRule: cssRule, key: style, value: args.value, match: cssRule.style[style].match(args.value) });\r\n                            }\r\n                        }\r\n                    }\r\n                    else {\r\n                        callback({ cssRule: cssRule, key: null, value: null, match: null });\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n        catch (e) { };\r\n    }\r\n}\r\n\r\nexport function getUrlObj(): any {\r\n    return Tools.hashToObj(document.location.href);\r\n}\r\nexport function getObjUrl(obj: Object): string {\r\n    return location.href.replace(/[\\?|&]hash=[^\\?|^&]*/, \"\") + Tools.objToHash(obj);\r\n}\r\nexport function isFrame(): boolean {\r\n    try {\r\n        return self !== top;\r\n    } catch (e) {\r\n        return true;\r\n    }\r\n}\r\nexport interface Wrapper<T> {\r\n    [key: string]: WrapperEntry<T>;\r\n}\r\nexport interface WrapperEntry<T> {\r\n    get: (target: T) => any;\r\n    set?: (target: T, value: any) => void;\r\n}\r\nexport function wrapType<T extends Object>(origConstr: new (...args: any[]) => T, wrapper: Wrapper<T>): void {\r\n    (<any>window)[origConstr.name] = function(a: any, b: any, c: any, d: any, e: any, f: any) {\r\n        var obj = new origConstr(a, b, c, d, e, f);\r\n        var proxyWrapper = new Proxy(obj, {\r\n            get: function(target: any, name: string) {\r\n                if (wrapper[name]) {\r\n                    return wrapper[name].get(target);\r\n                }\r\n                else if (typeof (<any>target)[name] === \"function\") {\r\n                    return (<any>target)[name].bind(target);\r\n                }\r\n                else {\r\n                    return (<any>target)[name];\r\n                }\r\n            }, set: function(target: any, name: string, value: any) {\r\n                if (wrapper[name]) {\r\n                    if (wrapper[name].set) {\r\n                        wrapper[name].set(target, value);\r\n                    }\r\n                }\r\n                else {\r\n                    (<any>target)[name] = value;\r\n                }\r\n                return true;\r\n            }\r\n        });\r\n        return proxyWrapper;\r\n    };\r\n}","\r\nimport { StringMap } from \"./types\";\r\n\r\nexport function getMsg(msgName: string, args?: StringMap) {\r\n    var msg = chrome.i18n.getMessage(msgName);\r\n    if (args) {\r\n        for (var key in args) {\r\n            msg = msg.replace(\"{\" + key + \"}\", args[key]);\r\n        }\r\n    }\r\n    return msg;\r\n}\r\n","\r\nimport * as Messages from \"OV/messages\";\r\nimport * as Environment from \"OV/environment\";\r\nimport * as Analytics from \"OV/analytics\";\r\nimport { StringMap } from \"OV/types\";\r\n\r\nimport { getRedirectHosts } from \"redirect_scripts_base\";\r\n\r\n\r\ninterface OpenTab {\r\n    url: string;\r\n}\r\n\r\ninterface SetIconPopup {\r\n    url?: string;\r\n}\r\n\r\ninterface SetIconText {\r\n    text?: string;\r\n}\r\n\r\ninterface DownloadFile {\r\n    url: string;\r\n    fileName: string;\r\n}\r\n\r\ninterface Alert {\r\n    msg: string;\r\n}\r\n\r\ninterface Promt extends Alert {\r\n    fieldText: string;\r\n}\r\n\r\nexport function toTopWindow(msg: { data: any, func: string }) {\r\n    return Messages.send({ data: msg.data, func: msg.func, bgdata: { func: \"toTopWindow\", data: {} } });\r\n}\r\nexport function toActiveTab(msg: { data: any, func: string }) {\r\n    return Messages.send({ data: msg.data, func: msg.func, bgdata: { func: \"toActiveTab\", data: {} } });\r\n}\r\nexport function toTab(msg: { data: any, func: string, query: chrome.tabs.QueryInfo }) {\r\n    return Messages.send({ data: msg.data, func: msg.func, bgdata: { func: \"toTab\", data: msg.query } });\r\n}\r\nexport function openTab(url: string) {\r\n    return Messages.send({ bgdata: { func: \"openTab\", data: { url: url } } });\r\n}\r\nexport function pauseAllVideos() {\r\n    return Messages.send({ bgdata: { func: \"pauseAllVideos\", data: {} } });\r\n}\r\nexport function setIconPopup(url?: string) {\r\n    return Messages.send({ bgdata: { func: \"setIconPopup\", data: { url: url } } });\r\n}\r\nexport function setIconText(text?: string) {\r\n    return Messages.send({ bgdata: { func: \"setIconText\", data: { text: text } } });\r\n}\r\nexport function downloadFile(dl: DownloadFile) {\r\n    return Messages.send({ bgdata: { func: \"downloadFile\", data: dl } });\r\n}\r\nexport function analytics(data: StringMap) {\r\n    return Messages.send({ bgdata: { func: \"analytics\", data: data } });\r\n}\r\nexport function redirectHosts() {\r\n    return Messages.send({ bgdata: { func: \"redirectHosts\", data: {} } });\r\n}\r\nexport function alert(msg: string) {\r\n    if (Environment.browser() == Environment.Browsers.Chrome) {\r\n        Messages.send({ bgdata: { func: \"alert\", data: { msg: msg } } });\r\n    }\r\n    else {\r\n        window.alert(msg);\r\n    }\r\n}\r\nexport function confirm(msg: string) {\r\n    if (Environment.browser() == Environment.Browsers.Chrome) {\r\n        return Messages.send({ bgdata: { func: \"confirm\", data: { msg: msg } } }).then(function(response) {\r\n            return response.data as boolean;\r\n        });\r\n    }\r\n    else {\r\n        return Promise.resolve(window.confirm(msg));\r\n    }\r\n}\r\nexport function prompt(data: Promt) {\r\n    if (Environment.browser() == Environment.Browsers.Chrome) {\r\n        return Messages.send({ bgdata: { func: \"prompt\", data: data } }).then(function(response) {\r\n            return { aborted: response.data.aborted, text: response.data.text };\r\n        });\r\n    }\r\n    else {\r\n        let value = window.prompt(data.msg, data.fieldText);\r\n        return Promise.resolve({ aborted: !value, text: value });\r\n    }\r\n}\r\nexport function sendMessage(tabid: number, msg: { func: string; data: any; }) {\r\n    return new Promise(function(response, reject) {\r\n        chrome.tabs.sendMessage(tabid, {\r\n            func: msg.func,\r\n            data: msg.data,\r\n            state: Messages.State.BGToMdw,\r\n            sender: { url: location.href },\r\n        } as Messages.Request, {\r\n                frameId: 0\r\n            }, function(resData: Messages.Response) {\r\n                if(resData.error) {\r\n                    reject(resData.error);\r\n                }\r\n                else {\r\n                    response(resData);\r\n                }\r\n            });\r\n    });\r\n}\r\n\r\nexport function setup() {\r\n    Messages.setupBackground({\r\n        toTopWindow: function(msg, bgdata, sender, sendResponse, sendError) {\r\n            var tabid = sender.tab.id;\r\n            chrome.tabs.sendMessage(tabid, msg, { frameId: 0 }, function(resData: Messages.Response) {\r\n                if(resData.error) {\r\n                    sendError(resData.error);\r\n                }\r\n                else {\r\n                    sendResponse(resData.data);\r\n                }\r\n\r\n            });\r\n        },\r\n        toActiveTab: function(msg, bgdata, sender, sendResponse, sendError) {\r\n            var tabid = sender.tab.id;\r\n            chrome.tabs.query({ active: true }, function(tabs) {\r\n                chrome.tabs.sendMessage(tabs[0].id, msg, { frameId: 0 }, function(resData: Messages.Response) {\r\n                    if(resData.error) {\r\n                        sendError(resData.error);\r\n                    }\r\n                    else {\r\n                        sendResponse(resData.data);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        toTab: function(msg, bgdata, sender, sendResponse, sendError) {\r\n            var tabid = sender.tab.id;\r\n            chrome.tabs.query(bgdata, function(tabs: chrome.tabs.Tab[]) {\r\n                chrome.tabs.sendMessage(tabs[0].id, msg, function(resData: Messages.Response) {\r\n                    if(resData.error) {\r\n                        sendError(resData.error);\r\n                    }\r\n                    else {\r\n                        sendResponse(resData.data);\r\n                    }\r\n                });\r\n            });\r\n        },\r\n        openTab: function(msg, bgdata: OpenTab, sender, sendResponse) {\r\n            chrome.tabs.create({ url: bgdata.url });\r\n        },\r\n        pauseAllVideos: function(msg, bgdata, sender, sendResponse) {\r\n            sendMessage(sender.tab.id, { func: \"pauseVideos\", data: null });\r\n        },\r\n        setIconPopup: function(msg, bgdata: SetIconPopup, sender, sendResponse) {\r\n            chrome.browserAction.setPopup({ tabId: sender.tab.id, popup: (bgdata && bgdata.url) ? bgdata.url : \"\" });\r\n        },\r\n        setIconText: function(msg, bgdata: SetIconText, sender, sendResponse) {\r\n            chrome.browserAction.setBadgeText({ text: (bgdata && bgdata.text) ? bgdata.text : \"\", tabId: sender.tab.id });\r\n        },\r\n        downloadFile: function(msg, bgdata: DownloadFile, sender, sendResponse) {\r\n            chrome.downloads.download({ url: bgdata.url, saveAs: true, filename: bgdata.fileName });\r\n        },\r\n        analytics: function(msg, bgdata: StringMap, sender, sendResponse) {\r\n            if (bgdata[\"el\"]) {\r\n                bgdata[\"el\"] = bgdata[\"el\"].replace(\"<PAGE_URL>\", sender.tab.url);\r\n            }\r\n            console.log(bgdata)\r\n            Analytics.fireEvent(bgdata[\"ec\"], bgdata[\"ea\"], bgdata[\"el\"]);\r\n        },\r\n        redirectHosts: function(msg, bgdata, sender, sendResponse) {\r\n            getRedirectHosts().then(function(redirectHosts) {\r\n                sendResponse({ redirectHosts: redirectHosts });\r\n            });\r\n        },\r\n        alert: function(msg, bgdata: Alert, sender, sendResponse) {\r\n            window.alert(bgdata.msg);\r\n        },\r\n        prompt: function(msg, bgdata: Promt, sender, sendResponse) {\r\n            var value = window.prompt(bgdata.msg, bgdata.fieldText);\r\n\r\n            if (value == null || value == \"\") {\r\n                sendResponse({ aborted: true, text: null });\r\n            } else {\r\n                sendResponse({ aborted: false, text: value });\r\n            }\r\n        },\r\n        confirm: function(msg, bgdata: Alert, sender, sendResponse) {\r\n            sendResponse(window.confirm(bgdata.msg));\r\n        }\r\n    });\r\n}","import * as VideoTypes from \"./video_types\";\r\n\r\nimport * as Tools from \"./OV/tools\";\r\nimport * as Analytics from \"./OV/analytics\";\r\nimport * as Environment from \"./OV/environment\";\r\nimport * as Page from \"./OV/page\";\r\nimport * as Messages from \"./OV/messages\";\r\nimport * as Storage from \"./OV/storage\";\r\n\r\nlet redirectHosts: Array<RedirectHost> = [];\r\n\r\nexport interface ScriptDetails {\r\n    url: string;\r\n    match: RegExpMatchArray;\r\n    hostname: string;\r\n    run_scope: RunScopes;\r\n}\r\nexport type RedirectScript = (details: ScriptDetails) => Promise<VideoTypes.VideoData>;\r\nexport const enum RunScopes {\r\n    document_start = \"document_start\",\r\n    document_idle = \"document_idle\",\r\n    document_end = \"document_end\"\r\n}\r\nexport interface RedirectScriptEntry {\r\n    urlPattern: RegExp;\r\n    runScopes: Array<{ run_at: RunScopes; script: RedirectScript; hide_page?: boolean; }>;\r\n};\r\nexport interface RedirectHost {\r\n    name: string;\r\n    scripts: Array<RedirectScriptEntry>;\r\n};\r\n\r\n\r\n\r\nexport function addRedirectHost(redirectHost: RedirectHost): void {\r\n    redirectHosts.push(redirectHost);\r\n}\r\nexport function isUrlRedirecting(url: string) {\r\n    if (Tools.parseUrlQuery(url)[\"ovignore\"] != \"true\") {\r\n        return false;\r\n    }\r\n    else {\r\n        for (let host of redirectHosts) {\r\n            for (let script of host.scripts) {\r\n                if (url.match(script.urlPattern)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexport function startScripts(scope: RunScopes) {\r\n    return new Promise(function(resolve, reject) {\r\n        if (Tools.parseUrlQuery(location.href)[\"ovignore\"] != \"true\") {\r\n            for (let host of redirectHosts) {\r\n                isScriptEnabled(host.name).then(function(isEnabled) {\r\n                    if (isEnabled) {\r\n                        for (let script of host.scripts) {\r\n                            let match = location.href.match(script.urlPattern);\r\n                            if (match) {\r\n                                console.log(\"Redirect with \" + host.name)\r\n                                for (let runScope of script.runScopes) {\r\n                                    if (runScope.run_at == scope) {\r\n                                        if (Page.isFrame()) {\r\n\r\n                                            resolve();\r\n                                        }\r\n                                        document.documentElement.hidden = runScope.hide_page !== false;\r\n                                        runScope.script({ url: location.href, match: match, hostname: host.name, run_scope: runScope.run_at }).then(function(videoData) {\r\n                                            videoData.origin = location.href;\r\n                                            videoData.host = host.name;\r\n                                            location.href = Environment.getVidPlaySiteUrl(VideoTypes.makeURLsSave(videoData));\r\n                                        }).catch(function(error: Error) {\r\n                                            document.documentElement.hidden = false;\r\n                                            console.error(error);\r\n                                            Analytics.fireEvent(host.name, \"Error\", JSON.stringify(Environment.getErrorMsg({ msg: error.message, url: location.href, stack: error.stack })))\r\n                                        });\r\n\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    });\r\n\r\n}\r\nexport function isScriptEnabled(name: string): Promise<boolean> {\r\n    return Storage.sync.get(name).then(function(value) {\r\n\r\n        return value == true || value == undefined || value == null;\r\n    });\r\n}\r\nexport function setScriptEnabled(name: string, enabled: boolean): Promise<{ success: boolean }> {\r\n    return Storage.sync.set(name, enabled);\r\n}\r\nexport function getRedirectHosts(): Promise<Array<RedirectHost>> {\r\n    return Promise.resolve().then(function() {\r\n        if (Environment.isBackgroundPage()) {\r\n            return redirectHosts;\r\n        }\r\n        else {\r\n            return Messages.send({ bgdata: { func: \"redirectHosts\", data: {} } }).then(function(response) {\r\n                return response.data.redirectHosts;\r\n            });\r\n        }\r\n    });\r\n}\r\n\r\n\r\n","import * as Page from \"OV/page\";\r\n\r\n\r\n\r\nexport interface HistoryEntry {\r\n    poster: string;\r\n    title: string;\r\n    origin: string;\r\n    stoppedTime: number;\r\n}\r\nexport interface VideoSource {\r\n    src: string;\r\n    type: string;\r\n    label: string;\r\n    res?: number;\r\n    default?: boolean;\r\n    dlsrc?: DownloadSource\r\n}\r\nexport interface DownloadSource {\r\n    src: string;\r\n    type: string;\r\n    filename?: string;\r\n}\r\nexport interface SubtitleSource {\r\n    src: string;\r\n    label: string;\r\n    kind: string;\r\n    language?: string;\r\n    default?: boolean;\r\n    cues?: VTTCue[]\r\n}\r\nexport interface VTTCue {\r\n    startTime: number;\r\n    endTime: number;\r\n    text: string;\r\n    id: string;\r\n    pauseOnExit: boolean;\r\n}\r\nexport interface VideoData {\r\n    poster: string;\r\n    title: string;\r\n    tracks: Array<SubtitleSource>;\r\n    src: Array<VideoSource>;\r\n    origin?: string;\r\n    host?: string;\r\n}\r\nexport function makeURLsSave(videoData: VideoData) {\r\n    for (let track of videoData.tracks) {\r\n        track.src = Page.getSafeURL(track.src);\r\n    }\r\n    for (let src of videoData.src) {\r\n        src.src = Page.getSafeURL(src.src);\r\n        if (src.dlsrc) {\r\n            src.dlsrc.src = Page.getSafeURL(src.dlsrc.src);\r\n        }\r\n    }\r\n    videoData.poster = Page.getSafeURL(videoData.poster);\r\n    return videoData;\r\n}\r\n","import * as Tools from \"./tools\";\r\nimport * as Messages from \"./messages\";\r\nimport * as Environment from \"./environment\";\r\nimport * as Storage from \"./storage\";\r\n\r\nexport function setupBG(): void {\r\n    Messages.setupBackground({\r\n        proxySetup: function(data, bgdata: Proxy, sender, sendResponse) {\r\n            _setup({ ip: bgdata.ip, port: bgdata.port, country: bgdata.country }).then(sendResponse);\r\n        },\r\n        proxyUpdate: function(data, bgdata, sender, sendResponse) {\r\n            _update().then(sendResponse);\r\n        },\r\n        proxyRemove: function(data, bgdata, sender, sendResponse) {\r\n            _remove();\r\n        },\r\n        proxyAddHostToList: function(data, bgdata, sender, sendResponse) {\r\n            _addHostToList(bgdata.host);\r\n        },\r\n        proxyNewProxy: function(data, bgdata, sender, sendResponse) {\r\n            _newProxy().then(sendResponse);\r\n        },\r\n        proxyGetCurrent: function(data, bgdata, sender, sendResponse) {\r\n            sendResponse(currentProxy);\r\n        }\r\n    });\r\n}\r\nexport interface Proxy {\r\n    ip: string;\r\n    port: number;\r\n    country?: string;\r\n    anonymity?: string;\r\n}\r\nlet currentProxy: Proxy | null = null;\r\nexport function setup(proxy: Proxy): Promise<Proxy> {\r\n\r\n    if (Environment.isBackgroundPage()) {\r\n        return _setup(proxy);\r\n    }\r\n    else {\r\n        return Messages.send({ bgdata: { func: \"proxySetup\", data: { proxy: proxy } } }).then(function(response) {\r\n            return response.data;\r\n        });\r\n    }\r\n}\r\nfunction _setup(proxy: Proxy): Promise<Proxy> {\r\n    return new Promise(function(resolve, reject) {\r\n\r\n        remove();\r\n        currentProxy = proxy;\r\n        Storage.sync.set(\"ProxyEnabled\", currentProxy);\r\n        if (Environment.browser() == Environment.Browsers.Chrome) {\r\n            var config = {\r\n                mode: \"pac_script\",\r\n                pacScript: {\r\n                    data: \"function FindProxyForURL(url, host) {\" +\r\n                    \"var hosts = \" + JSON.stringify(hosts) + \";\" +\r\n                    \"for(var host of hosts) {\" +\r\n                    \"if(url.indexOf(host) != -1) {\" +\r\n                    \"return 'PROXY \" + proxy.ip + \":\" + proxy.port + \"';\" +\r\n                    \"}\" +\r\n                    \"}\" +\r\n                    \"return 'DIRECT';\" +\r\n                    \"}\"\r\n                }\r\n            };\r\n            chrome.proxy.settings.set({ value: config, scope: 'regular' });\r\n        }\r\n        else {\r\n            browser.proxy.register(\"/proxy_scripts/pac_firefox.js\");\r\n            browser.runtime.sendMessage({ proxy: currentProxy, hosts: hosts }, { toProxyScript: true });\r\n        }\r\n        resolve(currentProxy);\r\n    });\r\n}\r\nexport function update(): Promise<Proxy> {\r\n    if (Environment.isBackgroundPage()) {\r\n        return _update();\r\n    }\r\n    else {\r\n        return Messages.send({ bgdata: { func: \"proxyUpdate\", data: {} } }).then(function(response) {\r\n            return response.data;\r\n        });\r\n    }\r\n}\r\nfunction _update(): Promise<Proxy> {\r\n    if (_isEnabled()) {\r\n        return setup(currentProxy);\r\n    }\r\n    else {\r\n        return Promise.reject(Error(\"Proxy can't be updated not enabled!\"));\r\n    }\r\n}\r\nexport function newProxy(): Promise<Proxy> {\r\n    if (Environment.isBackgroundPage()) {\r\n        return _newProxy();\r\n    }\r\n    else {\r\n        return Messages.send({ bgdata: { func: \"proxyNewProxy\", data: {} } }).then(function(response) {\r\n            return response.data;\r\n        });\r\n    }\r\n}\r\nlet triedProxies: Array<string> = [];\r\nlet proxies: Array<Proxy> = [];\r\nfunction _newProxy(): Promise<Proxy> {\r\n    if (_isEnabled()) {\r\n        triedProxies.push(currentProxy.ip);\r\n    }\r\n    if (proxies.length == 0 || triedProxies.length > 20 || triedProxies.length == proxies.length) {\r\n        return searchProxies().then(function(newproxies) {\r\n            proxies = newproxies;\r\n            triedProxies = [];\r\n\r\n            for (var proxy of proxies) {\r\n                if (triedProxies.indexOf(proxy.ip) == -1) {\r\n                    return _setup(proxy);\r\n                }\r\n            }\r\n            throw Error(\"Something went wrong!\");\r\n        });\r\n    }\r\n    else {\r\n        for (var proxy of proxies) {\r\n            if (triedProxies.indexOf(proxy.ip) == -1) {\r\n                return _setup(proxy);\r\n            }\r\n        }\r\n        throw Error(\"Something went wrong!\");\r\n    }\r\n\r\n}\r\nexport function isEnabled(): Promise<boolean> {\r\n    return getCurrentProxy().then(function(proxy) {\r\n\r\n        return proxy != null;\r\n    });\r\n}\r\nfunction _isEnabled(): boolean {\r\n    return currentProxy != null;\r\n}\r\nexport function getCurrentProxy(): Promise<Proxy> {\r\n    if (Environment.isBackgroundPage()) {\r\n        return Promise.resolve(currentProxy);\r\n    }\r\n    else {\r\n        return Messages.send({ bgdata: { func: \"proxyGetCurrent\", data: {} } }).then(function(response) {\r\n            return response.data;\r\n        });\r\n    }\r\n}\r\nexport function remove() {\r\n    if (Environment.isBackgroundPage()) {\r\n        _remove();\r\n    }\r\n    else {\r\n        Messages.send({ bgdata: { func: \"proxyRemove\", data: {} } });\r\n    }\r\n}\r\nfunction _remove() {\r\n    if (Environment.browser() == Environment.Browsers.Chrome) {\r\n        chrome.proxy.settings.clear({});\r\n    }\r\n    else {\r\n        browser.proxy.unregister();\r\n    }\r\n    currentProxy = null;\r\n    Storage.sync.set(\"ProxyEnabled\", false);\r\n}\r\nfunction searchProxies(): Promise<Array<Proxy>> {\r\n    var url = \"https://free-proxy-list.net/anonymous-proxy.html\";\r\n    return Tools.createRequest({ url: url }).then(function(xhr) {\r\n        let HTML = (new DOMParser()).parseFromString(xhr.response, \"text/html\");\r\n\r\n        var table = HTML.getElementsByTagName(\"table\")[0];\r\n        var tableRows = table.getElementsByTagName(\"tr\");\r\n        var proxies: Array<Proxy> = [];\r\n        for (let row of tableRows) {\r\n            if (row.cells[4].innerText == \"elite proxy\") {\r\n                proxies.push({\r\n                    ip: row.cells[0].innerText,\r\n                    port: parseInt(row.cells[1].innerText),\r\n                    country: row.cells[3].innerText,\r\n                    anonymity: row.cells[4].innerText\r\n                });\r\n            }\r\n        }\r\n        return proxies;\r\n    });\r\n\r\n}\r\nlet hosts: Array<string> = [];\r\nexport function addHostToList(host: string): void {\r\n    if (Environment.isBackgroundPage()) {\r\n        _addHostToList(host);\r\n    }\r\n    else {\r\n        Messages.send({ bgdata: { func: \"proxyAddHostToList\", data: { host: host } } });\r\n    }\r\n}\r\nfunction _addHostToList(host: string) {\r\n    if (hosts.indexOf(host) == -1) {\r\n        hosts.push(host);\r\n    }\r\n}\r\nexport function addHostsToList(hosts: Array<string>) {\r\n    for (var host of hosts) {\r\n        _addHostToList(host);\r\n    }\r\n}","import * as Storage from \"OV/storage\";\r\nimport * as Analytics from \"OV/analytics\";\r\nimport * as Page from \"OV/page\";\r\nimport * as Languages from \"OV/languages\";\r\nimport * as Messages from \"OV/messages\";\r\nimport * as Tools from \"OV/tools\";\r\nimport * as Environment from \"OV/environment\";\r\nimport * as Proxy from \"OV/proxy\";\r\n\r\nimport * as Metadata from \"Messages/metadata\";\r\n\r\nimport * as ScriptBase from \"redirect_scripts_base\";\r\nimport * as VideoTypes from \"video_types\";\r\nimport * as OVPlayer from \"ov_player\";\r\n\r\nimport videojs_raw from \"video.js\";\r\n\r\ndeclare var videojs: typeof videojs_raw;\r\n\r\n\r\n//declare var videojs : typeof videojs.default;\r\nPage.isReady().then(function(event) {\r\n    //(window as any).video_js_1.default = (window as any).videojs;\r\n    Metadata.requestPlayerCSS().then(function(css) {\r\n        if (css && css.doChange) {\r\n\r\n            Page.lookupCSS({ value: /rgba?\\(141, 199, 63,?([^\\)]*)?\\)/ }, function(data) {\r\n                data.cssRule.style[data.key] = css.color;\r\n            });\r\n            Page.lookupCSS({ value: /url\\(\"\\/assets\\/icons\\/playNormal\\.png\"\\)/ }, function(data) {\r\n                data.cssRule.style[data.key] = css.playimage;\r\n            });\r\n            Page.lookupCSS({ value: /url\\(\"\\/assets\\/icons\\/playHover\\.png\"\\)/ }, function(data) {\r\n                data.cssRule.style[data.key] = css.playhoverimage;\r\n            });\r\n            /*lookupCSS({ value: 'url(\"/assets/icons/reloadNormal.png\")' }, function(data){\r\n                data.cssRule.style[data.key] = response.reloadimage;\r\n            });\r\n            lookupCSS({ value: 'url(\"/assets/icons/reloadHover.png\")' }, function(data){\r\n                data.cssRule.style[data.key] = response.reloadhoverimage;\r\n            });*/\r\n        }\r\n    });\r\n    Proxy.getCurrentProxy().then(function(proxy) {\r\n        var msg = \"\";\r\n        if (proxy) {\r\n            msg = Languages.getMsg(\"video_player_err_msg_proxy\");\r\n        }\r\n        else {\r\n            msg = Languages.getMsg(\"video_player_err_msg\");\r\n        }\r\n        videojs.addLanguage('en', { \"The media could not be loaded, either because the server or network failed or because the format is not supported.\": msg });\r\n    });\r\n\r\n    document.getElementById(\"js_err_msg\").innerText = Languages.getMsg(\"video_player_js_err_msg\");\r\n\r\n    var Hash = Page.getUrlObj() as VideoTypes.VideoData;\r\n    document.title = Hash.title + \" - OpenVideo\"\r\n    Analytics.fireEvent(Hash.host, \"HosterUsed\", \"\");\r\n    OVPlayer.initPlayer('openVideo', {}, Hash);\r\n    //document.body.style.display = 'none'\r\n    //document.body.style.display = 'block'\r\n    if (Page.isFrame()) {\r\n        var TheaterButton = OVPlayer.getPlayer().getChild('controlBar').addChild('TheaterButton', {});\r\n        OVPlayer.getPlayer().on(\"ready\", function() {\r\n            /*TheatreMode.setupIframe({frameWidth: window.innerWidth, frameHeight: window.innerHeight}).then(function(data){\r\n                if(data && data.reload) {\r\n                    location.reload();\r\n                }\r\n            });*/\r\n            OVPlayer.getPlayer().controlBar.el().insertBefore(TheaterButton.el(), (OVPlayer.getPlayer().controlBar as any).fullscreenToggle.el());\r\n        });\r\n        OVPlayer.getPlayer().on(\"fullscreenchange\", function() {\r\n            (TheaterButton.el() as HTMLElement).style.display = OVPlayer.getPlayer().isFullscreen() ? \"none\" : \"inherit\";\r\n        });\r\n    }\r\n    OVPlayer.getPlayer().on('error', function() {\r\n        if ((OVPlayer.getPlayer() as any).readyState() == 0) {\r\n            //if(Response.status == 404 || Response.status == 400 || Response.status == 403) {\r\n\r\n            Analytics.fireEvent(Hash.host, \"Error\", JSON.stringify(Environment.getErrorMsg({ msg: OVPlayer.getPlayer().error().message, url: Hash.origin })));\r\n            //}\r\n            //document.location.replace(Hash.vidSiteUrl + (Hash.vidSiteUrl.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"ignoreRequestCheck=true\");\r\n        }\r\n        else {\r\n            OVPlayer.getPlayer().bigPlayButton.on(\"click\", function() {\r\n                location.replace(OVPlayer.getPlayer().getVideoData().origin);\r\n            });\r\n            OVPlayer.getPlayer().bigPlayButton.addClass(\"reloadButton\");\r\n        }\r\n\r\n    });\r\n});\r\n","\r\nimport * as Messages from \"OV/messages\";\r\nimport * as Environment from \"OV/environment\";\r\nimport * as Storage from \"OV/storage\";\r\nimport * as Page from \"OV/page\";\r\nimport * as Tools from \"OV/tools\";\r\n\r\nimport * as Background from \"./background\";\r\n\r\nfunction toDataURL(url: string): Promise<string> {\r\n    return Tools.createRequest({\r\n        url: url, beforeSend: function(xhr) {\r\n            xhr.responseType = 'blob';\r\n        }\r\n    }).then(function(xhr) {\r\n        return new Promise<string>(function(resolve, reject) {\r\n            var reader = new FileReader();\r\n            reader.onloadend = function() {\r\n                resolve(\"url(\" + reader.result + \")\");\r\n            }\r\n            reader.readAsDataURL(xhr.response);\r\n        });\r\n    });\r\n}\r\nexport interface PlayerStyle {\r\n    doChange: boolean;\r\n    color: string;\r\n    playimage: string;\r\n    playhoverimage: string;\r\n}\r\nexport function requestPlayerCSS() {\r\n    return Background.toTopWindow({ func: \"requestPlayerCSS\", data: {} }).then(function(response) {\r\n        return response.data as PlayerStyle;\r\n    });\r\n}\r\nexport function setup() {\r\n    Page.isReady().then(function(event) {\r\n        let ovtags = document.getElementsByTagName(\"openvideo\");\r\n        if (ovtags.length > 0) {\r\n            let ovtag = ovtags[0] as HTMLElement;\r\n            ovtag.innerText = Environment.getManifest().version;\r\n\r\n\r\n            /*var reloadimage = null;\r\n        if(ovtag.attributes.reloadimage) {\r\n            reloadimage = \"url(data:image/png;base64,\"+btoa(OV.tools.ajax({url: ovtag.attributes.reloadimage.value, async: false}).response)+\")\";\r\n        }\r\n        var reloadhoverimage = null;\r\n        if(ovtag.attributes.reloadhoverimage) {\r\n            reloadhoverimage = \"url(data:image/png;base64,\"+btoa(OV.tools.ajax({url: ovtag.attributes.reloadhoverimage.value, async: false}).response)+\")\";\r\n        }*/\r\n\r\n            let metadata: PlayerStyle = null;\r\n            Messages.addListener({\r\n                requestPlayerCSS: function(request, sendResponse) {\r\n                    if (metadata) {\r\n                        sendResponse(metadata);\r\n                    }\r\n                    else {\r\n                        Promise.all([toDataURL(ovtag.getAttribute(\"playimage\")), toDataURL(ovtag.getAttribute(\"playhoverimage\"))]).then(function(dataURLs) {\r\n                            metadata = { doChange: true, color: ovtag.getAttribute(\"color\"), playimage: dataURLs[0], playhoverimage: dataURLs[1] };\r\n                            sendResponse(metadata);\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n            //alert(\"W2\")\r\n            ovtag.dispatchEvent(new Event(\"ov-metadata-received\"));\r\n        }\r\n    });\r\n}","\r\n\r\nimport * as VideoTypes from \"./video_types\";\r\n\r\nimport * as Tools from \"./OV/tools\";\r\nimport * as Analytics from \"./OV/analytics\";\r\nimport * as Environment from \"./OV/environment\";\r\nimport * as Page from \"./OV/page\";\r\nimport * as Messages from \"./OV/messages\";\r\nimport * as Storage from \"./OV/storage\";\r\nimport * as Languages from \"./OV/languages\";\r\n\r\nimport * as OVPlayerComponents from \"./ov_player_components\";\r\n\r\nimport videojs_raw from \"video.js\";\r\n\r\ndeclare var videojs: typeof videojs_raw;\r\n\r\n(window as any)[\"Worker\"] = undefined;\r\nMessages.setupMiddleware();\r\nPage.wrapType(XMLHttpRequest, {\r\n    open: {\r\n        get: function(target) {\r\n            return function(method: string, url: string) {\r\n                if (getPlayer() && getPlayer().currentType().match(/application\\//i)) {\r\n                    arguments[1] = Tools.addRefererToURL(url, Page.getUrlObj().origin);\r\n                }\r\n                target.open.apply(target, arguments as any);\r\n            }\r\n        }\r\n    }\r\n});\r\nexport interface Player extends videojs_raw.Player {\r\n    hotkeys?: (obj: Object) => void;\r\n    getActiveVideoSource?: () => VideoTypes.VideoSource;\r\n    getVideoData?: () => VideoTypes.VideoData;\r\n    setVideoData?: (videoData: VideoTypes.VideoData) => void;\r\n    updateSrc?: (srces: Array<VideoTypes.VideoSource>) => void;\r\n    saveToHistory?: () => void;\r\n    loadFromHistory?: () => void;\r\n}\r\n\r\n\r\nlet player: Player = null;\r\nexport function parseSrt(dataAndEvents: string, oncue: (cue: VideoTypes.VTTCue) => void) {\r\n\r\n    function trim(dataAndEvents: string) {\r\n        return (dataAndEvents + \"\").replace(/^\\s+|\\s+$/g, \"\");\r\n    }\r\n    function parseCueTime(dataAndEvents: string): number {\r\n        var parts = dataAndEvents.split(\":\");\r\n        /** @type {number} */\r\n        var sum = 0;\r\n        var minutes;\r\n        var part;\r\n        var url;\r\n        var x;\r\n        var i;\r\n        if (parts.length == 3) {\r\n            minutes = parts[0];\r\n            part = parts[1];\r\n            url = parts[2];\r\n        } else {\r\n            minutes = \"0\";\r\n            part = parts[0];\r\n            url = parts[1];\r\n        }\r\n        url = url.split(/\\s+/);\r\n        x = url.splice(0, 1)[0];\r\n        x = x.split(/\\.|,/);\r\n        i = parseFloat(x[1]);\r\n        x = x[0];\r\n        sum += parseFloat(minutes) * 3600;\r\n        sum += parseFloat(part) * 60;\r\n        sum += parseFloat(x);\r\n        if (i) {\r\n            sum += i / 1E3;\r\n        }\r\n        return sum;\r\n    }\r\n\r\n    if (dataAndEvents == \"\") {\r\n        alert(\"Invalid srt file!\");\r\n    }\r\n    var tempData;\r\n    var splitted;\r\n    var collection;\r\n    var nodes = dataAndEvents.split(\"\\n\");\r\n    var resp = \"\";\r\n    var user_id;\r\n    var cuelength = 0;\r\n    var n = nodes.length;\r\n    for (var i = 1; i < n; ++i) {\r\n        resp = trim(nodes[i]);\r\n        if (resp) {\r\n            if (resp.indexOf(\"-->\") == -1) {\r\n                user_id = resp;\r\n                resp = trim(nodes[++i]);\r\n            } else {\r\n                user_id = cuelength;\r\n            }\r\n            tempData = {\r\n                id: user_id,\r\n                index: cuelength,\r\n                startTime: undefined,\r\n                endTime: undefined,\r\n                text: \"\"\r\n            };\r\n            splitted = resp.split(/[\\t ]+/);\r\n            tempData.startTime = parseCueTime(splitted[0]);\r\n            tempData.endTime = parseCueTime(splitted[2]);\r\n            /** @type {Array} */\r\n            collection = [];\r\n            for (; nodes[++i] && (resp = trim(nodes[i]));) {\r\n                collection.push(resp);\r\n            }\r\n            tempData.text = collection.join(\"\\n\");\r\n            oncue({ id: \"\", startTime: tempData.startTime, endTime: tempData.endTime, text: tempData.text, pauseOnExit: false });\r\n            cuelength += 1;\r\n        }\r\n    }\r\n}\r\nexport async function addTextTrack(player: Player, rawTrack: VideoTypes.SubtitleSource) {\r\n    function convertToTrack(srcContent : string) {\r\n        if (srcContent.indexOf(\"-->\") !== -1) {\r\n\r\n            player.addTextTrack(rawTrack.kind, rawTrack.label, rawTrack.language);\r\n            let track = player.textTracks()[player.textTracks().length - 1];\r\n            if (rawTrack.default) {\r\n                track.mode = \"showing\";\r\n            }\r\n            parseSrt(srcContent, function(cue) {\r\n                track.addCue(cue);\r\n            });\r\n\r\n        } else {\r\n            throw Error(\"Invaid subtitle file\");\r\n        }\r\n    }\r\n    try {\r\n        let xhr = await Tools.createRequest({ url: rawTrack.src });\r\n        convertToTrack(xhr.responseText);\r\n    }\r\n    catch(e) {\r\n        let xhr = await Tools.createRequest({ url: Tools.removeRefererFromURL(rawTrack.src) });\r\n        convertToTrack(xhr.responseText);\r\n    }\r\n}\r\nexport function getPlayer() {\r\n    return player;\r\n}\r\nexport function initPlayer(playerId: string, options: Object, videoData: VideoTypes.VideoData): Player {\r\n\r\n    OVPlayerComponents.register();\r\n    options = Tools.merge(options, {\r\n        plugins: {\r\n            videoJsResolutionSwitcher: {\r\n                dynamicLabel: true\r\n            }\r\n        },\r\n        /*chromecast:{\r\n             appId:'APP-ID'\r\n        },*/\r\n        playbackRates: [0.5, 1, 2],\r\n        language: Languages.getMsg(\"video_player_locale\")\r\n    });\r\n    player = videojs(playerId, options);\r\n    player.hotkeys({\r\n        volumeStep: 0.1,\r\n        seekStep: 5,\r\n        enableModifiersForNumbers: false\r\n    });\r\n\r\n    player.getActiveVideoSource = function(): VideoTypes.VideoSource {\r\n        for (var src of videoData.src) {\r\n            if (player.src().indexOf(src.src) == 0) {\r\n                return src;\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n\r\n    player.on(\"ready\", function() {\r\n        (player.el() as HTMLElement).style.width = \"100%\";\r\n        (player.el() as HTMLElement).style.height = \"100%\";\r\n        let ControlBar = player.getChild('controlBar');\r\n        var FavButton = ControlBar.addChild('FavButton', {}) as OVPlayerComponents.FavButton;\r\n        var DownloadButton = ControlBar.addChild('DownloadButton', {});\r\n        var PatreonButton = ControlBar.addChild('PatreonButton', {});\r\n        var FullscreenToggle = ControlBar.getChild('fullscreenToggle') as videojs_raw.FullscreenToggle;\r\n        var CaptionsButton = ControlBar.getChild('SubsCapsButton') as videojs_raw.CaptionsButton;\r\n        CaptionsButton.show();\r\n        player.on(\"ratechange\", function() {\r\n            Analytics.fireEvent(\"PlaybackRate\", \"PlayerEvent\", videoData.origin);\r\n        });\r\n        FullscreenToggle.on(\"click\", function() {\r\n            window.setTimeout(function() {\r\n                if (Environment.browser() == Environment.Browsers.Chrome && !(document as any).fullscreen && player.isFullscreen()) {\r\n                    console.log(\"FULLSCREEN ERROR\");\r\n                    Analytics.fireEvent(\"FullscreenError\", \"FullscreenError\", \"IFrame: '\" + videoData.origin + \"' Page: '<PAGE_URL>', Version: \" + Environment.getManifest().version)\r\n                }\r\n            }, 1000);\r\n        });\r\n        player.controlBar.el().insertBefore(FavButton.el(), CaptionsButton.el());\r\n        player.controlBar.el().insertBefore(DownloadButton.el(), FullscreenToggle.el());\r\n        player.controlBar.el().insertBefore(PatreonButton.el(), FullscreenToggle.el());\r\n        Storage.sync.get(\"PlayerVolume\").then(function(volume) {\r\n            if (volume) {\r\n                player.volume(volume);\r\n            }\r\n        });\r\n        player.on('volumechange', function() {\r\n            Storage.sync.set(\"PlayerVolume\", player.volume());\r\n        });\r\n        player.on('loadedmetadata', function() {\r\n            player.loadFromHistory();\r\n            FavButton.updateDesign();\r\n        });\r\n        document.body.onmouseleave = function() {\r\n            if (player.currentTime() != 0) {\r\n                player.saveToHistory();\r\n            }\r\n        };\r\n    });\r\n\r\n    player.setVideoData = function(videoData: VideoTypes.VideoData) {\r\n\r\n\r\n        player.poster(Tools.addParamsToURL(videoData.poster, { OVReferer: encodeURIComponent(btoa(videoData.origin)) }));\r\n        var srces = videoData.src;\r\n\r\n        var checkedSrces = [];\r\n        for (var src of srces) {\r\n            if (src.src != \"\") {\r\n                src.src = src.src + (src.src.indexOf(\"?\") == -1 ? \"?\" : \"&\") + \"isOV=true\";\r\n                checkedSrces.push(src);\r\n            }\r\n        }\r\n        srces = checkedSrces;\r\n        if (srces.length == 1) {\r\n            player.src(srces[0]);\r\n        }\r\n        else {\r\n            player.updateSrc(srces);\r\n\r\n\r\n        }\r\n        for (let track of videoData.tracks) {\r\n            addTextTrack(player, track);\r\n            //player.addRemoteTextTrack(<any>track, true);\r\n        }\r\n\r\n    }\r\n    player.getVideoData = function() {\r\n        return videoData;\r\n    }\r\n    player.setVideoData(videoData);\r\n\r\n    //player.aspectRatio(\"0:0\");\r\n    player.saveToHistory = function() {\r\n        Storage.sync.get(\"disableHistory\").then(function(disabled) {\r\n            if (!disabled) {\r\n                Storage.local.get(\"OpenVideoHistory\").then(function(history: Array<VideoTypes.HistoryEntry>) {\r\n                    if (!history) {\r\n                        history = [];\r\n                    }\r\n                    var itemIndex = history.indexOf(history.find(function(arrElem: VideoTypes.HistoryEntry) {\r\n                        return arrElem.origin == videoData.origin;\r\n                    }));\r\n                    if (itemIndex != -1) {\r\n                        history.splice(itemIndex, 1);\r\n                    }\r\n                    var histHash: VideoTypes.HistoryEntry = {\r\n                        poster: videoData.poster,\r\n                        title: videoData.title,\r\n                        origin: videoData.origin,\r\n                        stoppedTime: player.currentTime() == player.duration() ? 0 : player.currentTime()\r\n                    };\r\n\r\n\r\n                    //player.getVideoFileHash(function(fileHash){\r\n                    //HistHash.fileHash = fileHash;\r\n                    history.unshift(histHash);\r\n                    Storage.local.set(\"OpenVideoHistory\", history);\r\n                    //});\r\n                });\r\n            }\r\n        });\r\n    };\r\n    player.loadFromHistory = function() {\r\n        Storage.local.get(\"OpenVideoHistory\").then(function(history: Array<VideoTypes.HistoryEntry>) {\r\n            if (history) {\r\n                //player.getVideoFileHash(function(fileHash){\r\n                var item = history.find(function(arrElem) {\r\n                    return arrElem.origin == videoData.origin;\r\n                });\r\n                if (item) {\r\n                    player.currentTime(item.stoppedTime);\r\n                }\r\n                //});\r\n            }\r\n        });\r\n    };\r\n\r\n\r\n    return player;\r\n}\r\n","import * as OVPlayer from \"ov_player\";\r\n\r\nimport * as VideoTypes from \"video_types\";\r\n\r\nimport * as Tools from \"OV/tools\";\r\nimport * as Analytics from \"OV/analytics\";\r\nimport * as Environment from \"OV/environment\";\r\nimport * as Page from \"OV/page\";\r\nimport * as Messages from \"OV/messages\";\r\nimport * as Storage from \"OV/storage\";\r\nimport * as Languages from \"OV/languages\";\r\n\r\nimport * as TheatreMode from \"Messages/theatremode\";\r\nimport * as Background from \"Messages/background\";\r\n\r\nimport videojs_raw from \"video.js\";\r\n\r\ndeclare var videojs: typeof videojs_raw;\r\n\r\nexport interface FavButton extends videojs_raw.Button {\r\n    isFavorite: (value?: boolean, dontSet?: boolean) => boolean;\r\n    updateDesign: () => void;\r\n}\r\nexport interface TheatreButton extends videojs_raw.Button {\r\n    isTheatreMode: () => boolean;\r\n    setTheatreMode: (theatreMode: boolean) => void;\r\n}\r\nexport function createDownloadButton(url: string, fileName?: string, type?: string): HTMLButtonElement {\r\n    var button = document.createElement(\"button\");\r\n    button.className = \"vjs-menu-download-button-control\"\r\n    button.type = \"button\";\r\n    button.setAttribute(\"aria-live\", \"polite\");\r\n    button.setAttribute(\"aria-disabled\", \"false\");\r\n    var span = document.createElement(\"span\");\r\n    span.className = \"vjs-icon-placeholder\";\r\n    span.setAttribute('aria-hidden', \"true\");\r\n    button.appendChild(span);\r\n    button.addEventListener(\"click\", function(event: Event) {\r\n        event.stopPropagation();\r\n        if (type == null || type.indexOf(\"application/\") == -1) {\r\n            var dataHash = { url: url, fileName: \"\" };\r\n            if (fileName) {\r\n                dataHash.fileName = fileName.replace(/[/\\\\?%*:|\"<>]/g, ' ').trim();\r\n            }\r\n            Background.downloadFile(dataHash);\r\n        } else {\r\n            Background.alert(\"HLS videos can't be downloaded :/\\nTry downloading that video from a different hoster.\");\r\n        }\r\n    });\r\n    return button;\r\n}\r\nexport function register() {\r\n\r\n    let Button = videojs.getComponent(\"button\");\r\n    let favButton = (videojs as any).extend(Button, {\r\n        constructor: function(player: any, options: any) {\r\n            Button.call(this, player, options);\r\n            this.addClass('vjs-favbutton-disabled');\r\n        },\r\n        handleClick: function() {\r\n            Analytics.fireEvent(\"Favorites\", \"PlayerEvent\", \"\");\r\n            \r\n            this.setFavorite(!this.isFavorite());\r\n        },\r\n        isFavorite: function() {\r\n            return !!this.isFavorite_;\r\n        },\r\n        setFavorite: function(value: boolean, dontSet?: boolean): void {\r\n            this.isFavorite_ = value;\r\n            if (value) {\r\n                this.removeClass('vjs-favbutton-disabled');\r\n                this.addClass('vjs-favbutton-enabled');\r\n            }\r\n            else {\r\n                this.removeClass('vjs-favbutton-enabled');\r\n                this.addClass('vjs-favbutton-disabled');\r\n            }\r\n            var _this = this;\r\n            if (!dontSet) {\r\n                Storage.local.get(\"OpenVideoFavorites\").then(function(favorites: VideoTypes.HistoryEntry[]) {\r\n                    if (!favorites) {\r\n                        favorites = [];\r\n                    }\r\n                    var entryIndex = favorites.findIndex(function(arrElem) {\r\n                        return arrElem.origin == (_this.player_ as OVPlayer.Player).getVideoData().origin;\r\n                    });\r\n                    if (entryIndex != -1) {\r\n                        favorites.splice(entryIndex, 1);\r\n                    }\r\n                    if (value) {\r\n                        favorites.unshift((_this.player_ as OVPlayer.Player).getVideoData() as any);\r\n                    }\r\n                    Storage.local.set(\"OpenVideoFavorites\", favorites);\r\n                });\r\n            }\r\n        },\r\n        updateDesign: function() {\r\n            var _this = this;\r\n            Storage.local.get(\"OpenVideoFavorites\").then(function(favorites: VideoTypes.HistoryEntry[]) {\r\n                if (favorites) {\r\n                    _this.setFavorite(favorites.findIndex(function(arrElem) {\r\n                        return arrElem.origin == (_this.player_ as OVPlayer.Player).getVideoData().origin;\r\n                    }) != -1, true);\r\n                }\r\n            });\r\n        }\r\n    });\r\n\r\n    let theaterButton = (videojs as any).extend(Button, {\r\n        constructor: function(player: any, options: any) {\r\n            Button.call(this, player, options);\r\n            this.addClass('vjs-theaterbutton-disabled');\r\n            this.theaterMode = false;\r\n        },\r\n        handleClick: function() {\r\n            Analytics.fireEvent(\"TheaterMode\", \"PlayerEvent\", \"\");\r\n            this.setTheaterMode(!this.isTheaterMode());\r\n        },\r\n        isTheaterMode: function() {\r\n            return this.theaterMode;\r\n        },\r\n        setTheaterMode: function(theaterMode: boolean) {\r\n            this.theaterMode = theaterMode;\r\n            if (this.theaterMode) {\r\n                this.removeClass('vjs-theaterbutton-disabled');\r\n                this.addClass('vjs-theaterbutton-enabled');\r\n            }\r\n            else {\r\n                this.removeClass('vjs-theaterbutton-enabled');\r\n                this.addClass('vjs-theaterbutton-disabled');\r\n            }\r\n            TheatreMode.setTheatreMode(this.theaterMode);\r\n        }\r\n\r\n    });\r\n\r\n\r\n\r\n    let patreonButton = (videojs as any).extend(Button, {\r\n        constructor: function(player: any, options: any) {\r\n            Button.call(this, player, options);\r\n            this.addClass('vjs-patreonbutton');\r\n            this.controlText('Become a Patron');\r\n        },\r\n        handleClick: function() {\r\n            Analytics.fireEvent(\"PatreonButton\", \"PlayerEvent\", \"\");\r\n            Background.openTab(\"https://www.patreon.com/bePatron?u=13995915\");\r\n        }\r\n    });\r\n\r\n\r\n    let downloadButton = (videojs as any).extend(Button, {\r\n        constructor: function(player: any, options: any) {\r\n            Button.call(this, player, options);\r\n            this.addClass('vjs-download-button-control');\r\n        },\r\n        handleClick: function() {\r\n            var src = (this.player_ as OVPlayer.Player).getActiveVideoSource();\r\n            var file = Tools.merge(src.dlsrc || { src: src.src, type: src.type, filename: null }, { label: src.label });\r\n            if (file.type.indexOf(\"application/\") == -1) {\r\n                var dlData = { url: file.src, fileName: \"\" };\r\n                var label = file.label;\r\n                dlData.fileName = file.filename || (this.player_.getVideoData().title + \".\" + file.type.substr(file.type.indexOf(\"/\") + 1)).replace(/[/\\\\?%*:|\"<>]/g, ' ').trim();\r\n                if (label) {\r\n                    dlData.fileName = \"[\" + label + \"]\" + dlData.fileName;\r\n                }\r\n                console.log(dlData);\r\n                Background.downloadFile(dlData);\r\n            } else {\r\n                Background.alert(\"HLS videos can't be downloaded :/\\nTry downloading that video from a different hoster.\");\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n\r\n\r\n    let MenuItem = videojs.getComponent(\"MenuItem\");\r\n    let AddTracksFromFile = (videojs as any).extend(MenuItem, {\r\n        constructor: function(player: videojs_raw.Player, options: any) {\r\n            MenuItem.call(this, player, { label: \"load VTT/SRT from File\" });\r\n            this.controlText(\"load VTT/SRT from File\");\r\n            let srtSelector = document.createElement(\"input\") as HTMLInputElement;\r\n            srtSelector.type = \"file\";\r\n            srtSelector.accept = \".vtt, .srt, .txt\";\r\n            srtSelector.style.display = \"none\";\r\n            srtSelector.addEventListener(\"change\", function() {\r\n                var collection = new FileReader;\r\n                collection.onload = function(dataAndEvents) {\r\n                    let result = collection.result as string;\r\n                    if (result.indexOf(\"-->\") !== -1) {\r\n                        player.addTextTrack(\"captions\", srtSelector.files[0].name, \"AddedFromUser\");\r\n                        var track = player.textTracks()[player.textTracks().length - 1];\r\n                        OVPlayer.parseSrt(result, function(cue) {\r\n                            track.addCue(cue);\r\n                        });\r\n                    } else {\r\n                        Background.alert(\"Invaid subtitle file\");\r\n                    }\r\n                };\r\n                collection.readAsText(srtSelector.files[0], \"ISO-8859-1\");\r\n            });\r\n            this.srtSelector_ = srtSelector;\r\n        },\r\n        handleClick: function() {\r\n            var srtSelector = this.srtSelector_ as HTMLInputElement;\r\n            srtSelector.click();\r\n        }\r\n    });\r\n\r\n    let AddTracksFromURL = (videojs as any).extend(MenuItem, {\r\n        constructor: function(player: any, options: any) {\r\n            MenuItem.call(this, player, { label: \"load VTT/SRT from URL\" });\r\n            this.controlText(\"load VTT/SRT from URL\");\r\n        },\r\n        handleClick: function() {\r\n            let player = this.player_ as OVPlayer.Player;\r\n            Background.prompt({ msg: \"Please enter the url of the subtitle file you want to use\", fieldText: \"\" }).then(function(response) {\r\n                if (!response.aborted) {\r\n                    Tools.createRequest({ url: response.text }).then(function(xhr) {\r\n                        var srcContent = xhr.responseText;\r\n                        //function (srcContent) {\r\n                        if (srcContent.indexOf(\"-->\") !== -1) {\r\n                            Tools.getUrlFileName(response.text).then(function(fn) {\r\n                                player.addTextTrack(\"captions\", fn, \"AddedFromUser\");\r\n                                var track = player.textTracks()[player.textTracks().length - 1];\r\n                                OVPlayer.parseSrt(srcContent, function(cue) {\r\n                                    track.addCue(cue);\r\n                                });\r\n                            });\r\n                        } else {\r\n                            Background.alert(\"Invaid subtitle file\");\r\n                        }\r\n                    });\r\n\r\n\r\n                }\r\n\r\n            });\r\n\r\n        }\r\n    });\r\n    function override<T extends Function>(obj: any, method: T, createOverride: (method: T) => T ) {\r\n        let name = method.name;\r\n        obj.prototype[name] = createOverride(obj.prototype[name]);\r\n    }\r\n    let resolutionMenuItem = videojs.getComponent(\"ResolutionMenuItem\");\r\n    override(resolutionMenuItem, resolutionMenuItem.prototype.createEl, function(method){\r\n        return function(this: videojs_raw.MenuItem, tagName?: string, properties?: any, attributes?: any) {\r\n\r\n            let el = method.call(this, tagName, properties, attributes);\r\n            function getSrcElem(src: VideoTypes.VideoSource, videoTitle: string) {\r\n                return createDownloadButton(src.src, \"[\" + src.label + \"]\" + videoTitle + \".\" + src.type.substr(src.type.indexOf(\"/\") + 1), src.type);\r\n            }\r\n            let videoTitle = (this.player_ as OVPlayer.Player).getVideoData().title;\r\n            if ((this.options_ as any).src[0].dlsrc) {\r\n                el.appendChild(getSrcElem((this.options_ as any).src[0].dlsrc, videoTitle));\r\n            }\r\n            else {\r\n                el.appendChild(getSrcElem((this.options_ as any).src[0], videoTitle));\r\n            }\r\n            return el;\r\n        };\r\n    });\r\n    \r\n    let subsCapsMenuItem = videojs.getComponent(\"SubsCapsMenuItem\");\r\n    override(subsCapsMenuItem, subsCapsMenuItem.prototype.createEl, function(method){\r\n        return function(this: videojs_raw.TextTrackMenuItem, tagName?: string, properties?: any, attributes?: any) {\r\n            let btn = this;\r\n            let track = (btn.options_ as any).track as TextTrack;\r\n            let el = method.call(this, tagName, properties, attributes);\r\n            if (track.language != \"AddedFromUser\") {\r\n                let videoData = (btn.player_ as OVPlayer.Player).getVideoData();\r\n                let rawTrack = videoData.tracks.find(function(rawtrack) {\r\n                    return track.label == rawtrack.label;\r\n                });\r\n                if (rawTrack) {\r\n                    el.appendChild(createDownloadButton(rawTrack.src, \"[\" + rawTrack.label + \"]\" + videoData.title + \".vtt\", \"text/vtt\"));\r\n\r\n                }\r\n            }\r\n            return el;\r\n        }\r\n    });\r\n    \r\n    let subsCapsButton = videojs.getComponent(\"SubsCapsButton\") as any;\r\n    override(subsCapsButton, subsCapsButton.prototype.createItems, function(method){\r\n        return function(this: videojs_raw.MenuButton) {\r\n            let items = method.call(this) as Array<any>;\r\n            items.splice(2, 0, new (videojs.getComponent(\"AddTracksFromFile\"))(this.player_, {}));\r\n            items.splice(3, 0, new (videojs.getComponent(\"AddTracksFromURL\"))(this.player_, {}));\r\n            return items;\r\n        }\r\n    });\r\n\r\n\r\n\r\n    videojs.registerComponent('FavButton', favButton);\r\n    videojs.registerComponent('TheaterButton', theaterButton);\r\n    videojs.registerComponent('PatreonButton', patreonButton);\r\n    videojs.registerComponent('DownloadButton', downloadButton);\r\n    videojs.registerComponent('AddTracksFromURL', AddTracksFromURL);\r\n    videojs.registerComponent('AddTracksFromFile', AddTracksFromFile);\r\n}","\r\nimport * as Messages from \"OV/messages\";\r\nimport * as Storage from \"OV/storage\";\r\nimport * as Page from \"OV/page\";\r\nimport * as Tools from \"OV/tools\";\r\n\r\nimport * as Background from \"./background\";\r\n\r\n\r\n\r\ninterface IFrameEntry {\r\n    iframe: HTMLIFrameElement;\r\n    shadow: HTMLElement;\r\n    observer: MutationObserver;\r\n}\r\ntype IFrameEntries = Array<IFrameEntry>;\r\n\r\nlet iframes: IFrameEntries = [];\r\nlet activeEntry: { oldCSS: string; entry: IFrameEntry; } = null;\r\n\r\nfunction checkCleanup(entry: IFrameEntry) {\r\n    if (entry == null) {\r\n        return false;\r\n    }\r\n    else if (!entry.iframe || !entry.iframe.parentElement) {\r\n        entry.observer.disconnect();\r\n        entry.shadow.remove();\r\n        return true;\r\n    }\r\n    else {\r\n        return false;\r\n    }\r\n}\r\nexport function getActiveFrame() {\r\n    if (isFrameActive()) {\r\n        return activeEntry.entry;\r\n    }\r\n    else {\r\n        throw Error(\"No IFrame in theatre mode!\");\r\n    }\r\n}\r\nexport function isFrameActive() {\r\n    if (activeEntry && checkCleanup(activeEntry.entry)) {\r\n        activeEntry = null;\r\n    }\r\n    return activeEntry != null;\r\n}\r\n\r\nexport function getEntry(frameid: string) {\r\n    for (let i = 0; i < iframes.length; i++) {\r\n        if (checkCleanup(iframes[i])) {\r\n            iframes.splice(i, 1);\r\n            i--;\r\n        }\r\n        else if (iframes[i].iframe.name === frameid) {\r\n            return iframes[i];\r\n        }\r\n    }\r\n    return null;\r\n}\r\nexport function registerIFrame(iframe: HTMLIFrameElement) {\r\n\r\n    function matchesSelector(selector: string, element: HTMLElement) {\r\n        var all = document.querySelectorAll(selector);\r\n        for (var i = 0; i < all.length; i++) {\r\n            if (all[i] === element) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    let shadow = document.createElement(\"ovshadow\");\r\n\r\n    Page.lookupCSS({}, function(obj) {\r\n        if (obj.cssRule.selectorText.indexOf(\" iframe\") != -1) {\r\n            if (matchesSelector(obj.cssRule.selectorText, iframe)) {\r\n                if (obj.cssRule.style.width != \"\") {\r\n                    obj.cssRule.style.setProperty(\"width\", obj.cssRule.style.getPropertyValue(\"width\"), \"\");\r\n                    obj.cssRule.style.setProperty(\"height\", obj.cssRule.style.getPropertyValue(\"height\"), \"\");\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n\r\n\r\n    let observer = new MutationObserver(function(mutations) {\r\n        if (isFrameActive() && getActiveFrame().iframe == iframe) {\r\n            let newleft = Math.floor((window.innerWidth - iframe.clientWidth) / 2).toString() + \"px\";\r\n            let newtop = Math.floor((window.innerHeight - iframe.clientHeight) / 2).toString() + \"px\";\r\n            if (iframe.style.left != newleft) {\r\n                iframe.style.setProperty(\"left\", newleft);\r\n                iframe.style.setProperty(\"top\", newtop);\r\n            }\r\n        }\r\n\r\n    });\r\n    observer.observe(iframe, { attributes: true, attributeFilter: [\"style\"] });\r\n\r\n    shadow.className = \"ov-theaterMode\";\r\n    shadow.addEventListener(\"click\", function(e: MouseEvent) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    });\r\n    iframe.addEventListener(\"click\", function(e: MouseEvent) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n    });\r\n    iframe.parentNode.appendChild(shadow);\r\n\r\n    iframes.push({ shadow: shadow, iframe: iframe, observer: observer });\r\n    return iframes[iframes.length - 1];\r\n\r\n}\r\nexport function nameIFrames() {\r\n    function nameIFrame(iframe: HTMLIFrameElement) {\r\n        function checkBounds(iframe: HTMLIFrameElement) {\r\n\r\n\r\n            if(iframe.offsetLeft < 0 || iframe.offsetTop < 0) {\r\n\r\n                return false;\r\n            }\r\n            else if((iframe.offsetWidth / window.innerWidth)*100 < 30 || (iframe.offsetHeight / window.innerHeight)*100 < 30) {\r\n\r\n                return false;\r\n            }\r\n            else {\r\n                return true;\r\n            }\r\n        }\r\n        if (!iframe.hasAttribute(\"name\") && (checkBounds(iframe) || (iframe.hasAttribute(\"allow\") && iframe.getAttribute(\"allow\").indexOf(\"fullscreen\") != -1))) {\r\n            console.log(iframe);\r\n            iframe.name = Tools.generateHash();\r\n            if (iframe.width) {\r\n                iframe.style.width = iframe.width;\r\n                iframe.removeAttribute(\"width\");\r\n            }\r\n            if (iframe.height) {\r\n                iframe.style.height = iframe.height;\r\n                iframe.removeAttribute(\"height\");\r\n            }\r\n            if (iframe.hasAttribute(\"allow\")) {\r\n                iframe.setAttribute(\"allow\", iframe.getAttribute(\"allow\").replace(/fullscreen[^;]*;?/i, \"fullscreen *;\"));//fullscreen *;\r\n            }\r\n            iframe.allowFullscreen = true;\r\n            let sibling = iframe.nextElementSibling;\r\n            let parent = iframe.parentElement;\r\n            iframe.remove();\r\n            parent.insertBefore(iframe, sibling);\r\n        }\r\n    }\r\n    Page.isReady().then(function() {\r\n        for (let iframe of document.getElementsByTagName(\"iframe\")) {\r\n            nameIFrame(iframe);\r\n        }\r\n    });\r\n    Page.onNodeInserted(document, function(tgt) {\r\n\r\n        let target = tgt as HTMLIFrameElement;\r\n        if (target.getElementsByTagName) {\r\n            let iframes = target.getElementsByTagName(\"iframe\");\r\n\r\n            if (target.nodeName.toLowerCase() === \"iframe\") {\r\n                nameIFrame(target);\r\n            }\r\n            for (let iframe of iframes) {\r\n                nameIFrame(iframe);\r\n            }\r\n        }\r\n\r\n    });\r\n}\r\nexport function activateEntry(entry: IFrameEntry) {\r\n    if (isFrameActive()) {\r\n        console.log(activeEntry);\r\n        throw Error(\"Some IFrame is already in theatre mode!\");\r\n    }\r\n    else if (entry == null) {\r\n        throw Error(\"Entry must not be null!\");\r\n    }\r\n    else {\r\n        document.body.style.overflow = \"hidden\";\r\n        activeEntry = { oldCSS: entry.iframe.style.cssText, entry: entry };\r\n        Storage.sync.get(\"TheatreModeFrameWidth\").then(function(frameWidth) {\r\n            setWrapperStyle(entry, frameWidth || 70);\r\n        });\r\n        entry.shadow.style.opacity = \"1\";\r\n        entry.shadow.style.pointerEvents = \"all\";\r\n\r\n    }\r\n}\r\nexport function deactivateEntry() {\r\n    if (!isFrameActive()) {\r\n        throw Error(\"No IFrame is in theatre mode!\");\r\n    }\r\n    let entry = activeEntry;\r\n    activeEntry = null;\r\n    let newrelwidth = Math.floor((entry.entry.iframe.clientWidth / window.innerWidth) * 100);\r\n    console.log(newrelwidth);\r\n    Storage.sync.set(\"TheatreModeFrameWidth\", newrelwidth);\r\n    entry.entry.shadow.style.opacity = \"0\";\r\n    entry.entry.shadow.style.removeProperty(\"pointer-events\");\r\n    window.setTimeout(function() {\r\n        entry.entry.iframe.style.cssText = entry.oldCSS;\r\n        document.body.style.removeProperty(\"overflow\");\r\n    }, 150);\r\n}\r\n\r\n\r\nfunction setWrapperStyle(entry: IFrameEntry, width: number): void {\r\n    width = width > 100 ? 100 : width;\r\n    width = width < 50 ? 50 : width;\r\n    entry.iframe.style.cssText = \"padding-right:5px;padding-bottom:5px;display:block;overflow: hidden; resize: both;position: fixed !important;width: \" + width + \"vw !important;height: calc(( 9/ 16)*\" + width + \"vw) !important;top: calc((100vh - ( 9/ 16)*\" + width + \"vw)/2) !important;left: calc((100vw - \" + width + \"vw)/2) !important;z-index:2147483647 !important; border: 0px !important; max-width:100vw !important; min-width: 50vw !important; max-height: 100vh !important; min-height: 50vh !important\";\r\n}\r\nfunction getIFrameByID(frameid: string): HTMLIFrameElement {\r\n\r\n    let iframe = document.getElementsByName(frameid)[0] as HTMLIFrameElement;\r\n    if (iframe) {\r\n        return iframe;\r\n    }\r\n    else {\r\n        throw Error(\"Could not find iframe with id '\" + frameid + \"'!\");\r\n    }\r\n}\r\nexport interface SetupIFrame {\r\n    frameID: string;\r\n    url: string;\r\n}\r\nexport interface SetTheatreMode extends SetupIFrame {\r\n    enabled: boolean;\r\n}\r\nexport function setTheatreMode(enabled: boolean) {\r\n    Background.toTopWindow({ data: { enabled: enabled, frameID: window.name } as SetTheatreMode, func: \"setTheatreMode\" });\r\n}\r\nexport function setupIframe() {\r\n    Background.toTopWindow({ data: { frameID: window.name, url: location.href } as SetupIFrame, func: \"setupIframe\" });\r\n}\r\nexport function setup() {\r\n    nameIFrames();\r\n    Messages.addListener({\r\n        setTheatreMode: function(request, sendResponse) {\r\n            var data = request.data as SetTheatreMode;\r\n            if (data.enabled) {\r\n                var entry = getEntry(data.frameID);\r\n                activateEntry(entry);\r\n            }\r\n            else {\r\n                deactivateEntry();\r\n            }\r\n        },\r\n        setupIframe: function(request, sendResponse) {\r\n            let data = request.data as SetupIFrame;\r\n            var entry = getEntry(data.frameID);\r\n            if (!entry) {\r\n                let iframe = getIFrameByID(data.frameID);\r\n                //iframe.src = data.url;\r\n                entry = registerIFrame(iframe);\r\n            }\r\n        }\r\n    });\r\n}\r\n"],"sourceRoot":""}